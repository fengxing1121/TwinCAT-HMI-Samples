<!-- KEEP THIS PART FOR VisualStudio IN THE FIRST 10 LINES
    type:login
-->
<head>
    <!-- Title of the custom login page -->
    <title>Custom Login</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8" />
</head>


<style>
    /* Styles for custom login page
    Overwrite or add new styles here
    */
    body {
        font-family: Segoe UI,Tahoma,Arial,Verdana;
        color: #4c6374;
        font-size: 12px;
        padding: 0px;
        margin: 0;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        background-image: radial-gradient(#D7DCE2, #A3ADB7);
        overflow: hidden;
    }
    a {
        color: #4794da;
    }

    .outer-container {
        width: 100%;
        display: flex;
        flex-grow: 1;
        position: relative;
        min-height: 0;
    }

    div.main-container {
        box-sizing: border-box;
        float: left;
        width: 100%;
        flex-grow: 1;
        display: flex;
        overflow: auto;
        margin-top: 46px;
        padding-bottom: 32px;
        max-height: none;
    }

    .login-container {
        background-color: rgba(255,255,255,0.5);
        border-color: #666666;
        border-width: 1px;
        border-style: solid;
        padding: 30px;
        margin: auto;
    }

    .error {
        color: #FF0000;
        display: block;
        width: 165px;
        margin-bottom: 15px
    }

    .header {
        box-sizing: border-box;
        width: 100%;
        position: fixed;
        display: table;
        background-color: #4c6374;
        height: 46px;
        font-weight: normal;
    }

    .header-text {
        color: white;
        font-size: 20px;
        display: table-cell;
        vertical-align: middle;
    }

        .header-text.left {
            padding-left: 15px;
            text-align: left;
        }

        .header-text.right {
            padding-right: 15px;
            text-align: right;
        }

    .footer {
        box-sizing: border-box;
        background-color: #4c6374;
        position: fixed;
        bottom: 0;
        width: 100%;
        height: 32px;
        line-height: 32px;
        color: white;
        vertical-align: middle;
        padding-left: 10px;
    }

    h3 {
        font-weight: normal;
        font-size: 18px;
        margin-bottom: 15px;
        margin-top: 0;
        display: block;
    }

    p {
        margin-top: 0;
        text-align: justify;
        display: block;
        margin-block-end: 1em;
        margin-inline-start: 0px;
        margin-inline-end: 0px;
    }

    .login-container label {
        display: block;
        margin-bottom: 10px;
    }

    input, button, textarea, select {
        width: 165px;
        font-size: 100%;
        background-color: white;
        padding: 0;
        margin: 0;
        height: 22px;
        box-sizing: border-box;
        display: inline-block;
        text-align: start;
        cursor: text;
        border: none;
        box-shadow: inset 0px 0px 0px 1px rgba(0,0,0,0.02), inset 0px 0px 3px 2px rgba(0,0,0,0.3);
        color: #4c6374;
    }

        input[type=checkbox] {
            width: 16px;
            box-sizing: border-box;
            vertical-align: middle;
            float: right;
            cursor: pointer;
            box-shadow: none;
        }

        input[type=button], input[type=submit], button {
            border: 0px;
            cursor: pointer;
            text-align: center;
            background-image: linear-gradient(135deg, #eff1f3, #aeb9c2);
            box-shadow: 0px 0px 5px 0px rgba(0,0,0,0.6);
            color: #4794da;
        }

    select {
        color: black;
        cursor: default;
        border-radius: 0px;
        align-items: center;
        white-space: pre;
    }

        select option {
            font-weight: normal;
            display: block;
            white-space: pre;
            min-height: 1.2em;
            padding: 0px 2px 1px;
            background-color: rgb(156, 161, 165);
            color: white;
        }

    #switch-user-info {
        padding-top: 10px;
        width: 165px;
    }

    @media (max-height: 574px) {
        .login-container .break {
            display: none;
        }

        .login-container h3 {
            margin-bottom: 5px;
        }

        .login-container input, .login-container select {
            float: right;
            margin-left: 5px;
        }

        input[type=button], input[type=submit], button {
            width: 100%;
        }

        .error {
            width: 224px;
        }
        #switch-user-info {
            width: 100%;
        }
    }
</style>

<body>
    <div class="outer-container">
        <!-- HTML for custom login page-->
        <!-- Make your changes here -->
        <div class="header">
            <div class="header-text left">Custom Login Page</div>
            <div class="header-text right">Company Name</div>
        </div>
        <div class="main-container content">
            <div class="login-container">
                <!-- will be overwritten later if this acts as a switch user page -->
                <h3 id="title">Custom Login</h3>
                <label>
                    Username
                    <div class="break"></div>
                    <!-- drop down list -->
                    <select id="user-list"></select>
                    <!-- needed for password manager in Google Chrome -->
                    <input id="user-name-input" class="user-name-input" type="text" style="display: none;">
                </label>
                <label>
                    Password
                    <div class="break"></div>
                    <input id="password-input" type="password" autofocus autocomplete="off">
                </label>

                <label>
                    Stay logged in
                    <input id="stay-logged-in-input" type="checkbox">
                </label>
                <!-- will be overwritten later if this acts as a switch user page -->
                <button id="login-button" type="button">Login</button>
                <div></div>
                <div id="switch-user-info">

                </div>
            </div>
        </div>
        <div class="footer" id="version">loading...</div>
    </div>


    <!-- #region Script for custom login page
    Overwrite or add new code here
    -->
    <script>

        /** called if the page is loaded
         */
        window.addEventListener('load', function () {

            /** User list element in html
             * @type {HTMLSelectElement} */
            var userList = document.getElementById('user-list');

            /** Login button element in html
             * @type {HTMLButtonElement} */
            var loginButton = document.getElementById('login-button');

            /** Password input element in html
             * @type {HTMLInputElement} */
            var passwordInput = document.getElementById('password-input');

            /** Input element for user name
             * @type {HTMLInputElement} */
            var userInput = document.getElementById('user-name-input');

            /** Input element for stay logged in option
             * @type {HTMLInputElement} */
            var stayLoggedInInput = document.getElementById('stay-logged-in-input');

            /** Show / hide keyboard button element in html
             * @type {HTMLDivElement} */
            var toggleKeyboardButton = document.getElementsByClassName('keyboard-toggle')[0];


            // call listUserNames to list all users in the project
            listUserNames(userList);

            // register onchange event to update the password input element on selection changed
            userList.onchange = function () {
                // needed from password save support in Google Chrome
                if (this.nextElementSibling != null) {
                    this.nextElementSibling.value = this.value;
                }
            };

            // add event listener for enter key to login with enter after password input
            passwordInput.addEventListener('keydown', function (event) {
                if (event.key === "Enter") {
                    // proceed a login
                    loginButton.click();
                }
            });

            // register onclick event for login button to proceed a login
            loginButton.onclick = function () {
                // proceed a login with current values
                login(userInput.value, passwordInput.value, stayLoggedInInput.checked);
            };

            // register onclick event for button to set focus in password input
            toggleKeyboardButton.onclick = function () {
                // set focus on password input
                var firstpasswordInput = document.querySelector('input[autofocus]');
                if (firstpasswordInput) {
                    firstpasswordInput.focus();
                }
            };
        });

        /**
         * Send WebSocket request for login with username, password and stay logged in option
         * @param {string} username
         * @param {string} password
         * @param {boolean} stayLoggedIn
         */
        function login(username, password, stayLoggedIn) {
            var url = currentWebsocket();
            try {
                // open new WS connection
                var ws = new WebSocket(url);
            } catch (ex) {
                if (ex instanceof Error) {
                    showError("WebSocket error!", "Could not connect to " + url + ". " + ex.message);
                } else {
                    showError("WebSocket error!", "Could not connect to " + url + ".");
                }
                // abort
                return;
            }

            // send WS request
            ws.onopen = function () {
                // build message
                var message = {
                    "requestType": "ReadWrite",
                    "commands": [
                        {
                            "commandOptions": ["SendErrorMessage", "SendWriteValue"],
                            "symbol": "Login",
                            "writeValue":
                            {
                                "userName": username,
                                "password": password,
                                "persistent": stayLoggedIn
                            }
                        }
                    ]
                };

                ws.send(JSON.stringify(message));
            };

            // react on WS response
            ws.onmessage = function (messageEvent) {
                // parse response to JSON object
                var jsonObj = JSON.parse(messageEvent.data);

                // check for errors
                if (jsonObj && jsonObj.commands[0].error) {
                    if (jsonObj.commands[0].error.message) {
                        // print error on screen
                        showError("Login failed.", jsonObj.commands[0].error.message);
                        // clear password field
                        var passwordInput = document.getElementById('password-input');
                        passwordInput.value = "";
                    }
                } else {
					if (stayLoggedIn) {
                        // Remember the current session for 30 days
                        document.cookie = "sessionId=" + jsonObj.sessionId + ";path=/;max-age=" + 60 * 60 * 24 * 30;
                    } else {
						// Reset max-age
						document.cookie = "sessionId=" + jsonObj.sessionId + ";path=/";
                    }
                    // login was successful, load base url
                    if (window.location.href.indexOf("Login") != -1) {
                        window.location.href = window.location.href.replace(/Login.*?\//, '');
                    }
                    else
                    {
                        window.location.reload();
                    }
                }
            };

            // show WS errors
            ws.onerror = function (errorEvent) {
                showError("WebSocket error!", errorEvent.data);
            };
        }

        /**
         * Send WebSocket request to get a list of the user names
         * @param {HTMLSelectElement} selectElement
         */
        function listUserNames(selectElement) {
            // open new WS connection
            var url = currentWebsocket();
            try {
                // open new WS connection
                var ws = new WebSocket(url);
            } catch (ex) {
                if (ex instanceof Error) {
                    showError("WebSocket error!", "Could not connect to " + url + ". " + ex.message);
                } else {
                    showError("WebSocket error!", "Could not connect to " + url + ".");
                }
                // abort
                return;
            }

            // send WS request
            ws.onopen = function () {
                // build message
                var message = {
                    "requestType": "ReadWrite",
                    "commands": [
                        {
                            "commandOptions": ["SendErrorMessage", "SendWriteValue"],
                            "symbol": "GetCurrentUser::name"
                        },
                        {
                            "commandOptions": ["SendErrorMessage", "SendWriteValue"],
                            "symbol": "ListUserNames"
                        },
                        {
                            "commandOptions": ["SendErrorMessage", "SendWriteValue"],
                            "symbol": "UserSelectType"
                        },
                        {
                            "commandOptions": ["SendErrorMessage", "SendWriteValue"],
                            "symbol": "ListDomains::TcHmiSrv::productVersion"
                        }
                    ]
                };

                ws.send(JSON.stringify(message));
            };

            // react on WS response
            ws.onmessage = function (messageEvent) {
                // parse response to JSON object
                var jsonObj = JSON.parse(messageEvent.data);

                // check for errors in response
                if (jsonObj && jsonObj.error) {
                    if (jsonObj.error.message) {
                        showError("List users failed.", jsonObj.error.message);
                    }
                }
         
                // check if user name list exists inside response
                if (jsonObj
                    && jsonObj.commands
                ) {
                    var currentUserNameCommand = null;
                    var listUserNamesCommand = null;
                    var productVersionCommand = null;
                    var userSelectTypeCommand = null;
                    for (var i = 0; i < jsonObj.commands.length; i++) {
                        if (jsonObj.commands[i].symbol == "GetCurrentUser::name") {
                            currentUserNameCommand = jsonObj.commands[i];
                        } else if (jsonObj.commands[i].symbol == "ListUserNames") {
                            listUserNamesCommand = jsonObj.commands[i];
                        } else if (jsonObj.commands[i].symbol == "ListDomains::TcHmiSrv::productVersion") {
                            productVersionCommand = jsonObj.commands[i];
                        } else if (jsonObj.commands[i].symbol == "UserSelectType") {
                            userSelectTypeCommand = jsonObj.commands[i];
                        }
                    }

                    if (currentUserNameCommand && currentUserNameCommand.readValue) {
                        if (currentUserNameCommand.readValue !== "__SystemGuest") {
                            var titleDiv = document.getElementById('title');
                            if (titleDiv) {
                                titleDiv.innerHTML = 'Switch user';
                            }
                            var submitButton = document.getElementById('login-button');
                            if (submitButton) {
                                submitButton.innerHTML = 'Switch';
                            }
                            var activeLogin = document.getElementById('switch-user-info');
                            if (activeLogin) {
                                activeLogin.innerHTML = "Logged in as " + currentUserNameCommand.readValue +
                                    "<div></div><a href='/'>Start page</a>";
                            }
                        }
                    }
                    if (userSelectTypeCommand && userSelectTypeCommand.readValue === 1) {
                        // we should show a textfield
                        updateUserSelection(selectElement, null);
                    } else {
                        if (listUserNamesCommand) {
                            // build selection options with user names (could be undefined when we have no access)
                            updateUserSelection(selectElement, listUserNamesCommand.readValue);
                        }
                    }
                    if (productVersionCommand && productVersionCommand.readValue) {
                        // print server version
                        var versionTarget = document.getElementById("version");
                        if (versionTarget) {
                            versionTarget.innerText = "TwinCAT HMI version: " + productVersionCommand.readValue;
                        }
                    }
                }
            }; 

        
                    // show WS errors
            ws.onerror = function (errorEvent) {
                showError("WebSocket error!", errorEvent.data);
            };
        }

        /**
         * Update user list dependent on user name list
         * @param {HTMLSelectElement} selectElement
         * @param {string[] | null | undefined} userArr User list or null/undefined if textbox should be used
         */
        function updateUserSelection(selectElement, userArr) {
            /** Input element for user name
             * @type {HTMLInputElement} */
            var userInput = document.getElementById('user-name-input');
            if (userArr && userArr.length) {
                // create one option per entry
                for (var i = 0; i < userArr.length; i++) {
                    // uncomment if you want to left out the internal __SystemAdministrator user
                    // only if you have another user that is member of __SystemAdministrators group
                    /*if (userArr[i] === "__SystemAdministrator") {
                        continue;
                    }*/

                    // create new option element
                    var opt = document.createElement('option');
                    // set value and text to current user name
                    opt.value = userArr[i];
                    opt.innerHTML = userArr[i];
                    // add option to selection field
                    selectElement.add(opt);
                }
                // set the input field to first entry in the list
                if (userInput && selectElement.childElementCount) {
                    userInput.value = selectElement.firstElementChild.value;
                }
            } else {
                // we have no right to list the users
                // show input element and hide list
                var userList = document.getElementById('user-list');
                if (userList) {
                    userList.style.display = 'none';
                    // show textbox
                    userInput.style.display = '';
                }
            }
        }

        /**
         * Show errors on page
         *
         * @param {string} type Prefix of error message
         * @param {string} message Message itself
         */
        function showError(type, message) {
            /** Login container element in html
             * @type {HTMLDivElement}
             */
            var loginContainer = document.querySelector('.login-container');

            var errMsg;

            // check message and build output string
            if (message === "AUTH_FAILED") {
                errMsg = type + '<br>' + "Invalid username or password.";
            }
            else if (message === "AUTH_WAIT") {
                errMsg = type + '<br>' + "Too many failed login attempts. Please try again later.";
            } else {
                errMsg = type + '<br>' + message;
            }

            if (loginContainer) {
                // remove previous error element
                if (loginContainer.firstElementChild.tagName === "P") {
                    loginContainer.removeChild(loginContainer.firstElementChild);
                }

                // create error text element
                var errorElement = document.createElement("p");

                // add style and output string
                errorElement.classList.add('error');
                errorElement.innerHTML = errMsg;

                // append error message on top of the login container
                loginContainer.insertBefore(errorElement, loginContainer.firstElementChild);
            }
        }

        // get current WebSocket url
        function currentWebsocket() {
            if (window.location.protocol == "https:") {
                return "wss://" + window.location.host;
            }
            else {
                return "ws://" + window.location.host;
            }
        }
    </script>

    <!-- #endregion -->
    <!-- #region Keyboard element
        ##################################
        Do not make any changes here
        -->
    <div class="keyboardcontainer hidden">
        <div class="keyboard-toggle">
            <svg version="1.1" baseProfile="full" width="100%" height="100%" viewBox="0 0 28 28">
                <g class="hidden-icon">
                    <rect x="0.5" y="7.5" width="27" height="13" />

                    <rect x="2.5" y="9.5" width="3" height="3" />
                    <rect x="7.5" y="9.5" width="3" height="3" />
                    <rect x="12.5" y="9.5" width="3" height="3" />
                    <rect x="17.5" y="9.5" width="3" height="3" />
                    <rect x="22.5" y="9.5" width="3" height="3" />


                    <rect x="2.5" y="15.5" width="3" height="3" />
                    <rect x="7.5" y="15.5" width="13" height="3" />
                    <rect x="22.5" y="15.5" width="3" height="3" />
                </g>
                <g class="shown-icon">
                    <line x1="0" y1="0" x2="28" y2="28" />
                    <line x1="28" y1="0" x2="0" y2="28" />
                </g>
            </svg>
        </div>
        <div id="TcHmiKeyboard" class="tchmi-keyboard numlock-active default-active">
            <div class="tchmi-keyboard-template tchmi-box">
                <div class="tchmi-keyboard-template-padding-container">
                    <div class="tchmi-keyboard-template-layout de-de_qwertz" data-width="770" data-height="230" style="display: none;">
                        <div class="tchmi-keyboard-template-key" data-code="KeyQ" data-key="q" data-shift-key="Q" data-longpress-action="additionalKeys" style="top: 0%; left: 0%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 220%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="Digit1" data-key="1" data-shift-key="1" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">1</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyQ" data-key="@" data-shift-key="@" style="top: -120%; left: 120%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">@</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default">q</span>
                            <span class="tchmi-keyboard-template-label show-shift">Q</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyW" data-key="w" data-shift-key="W" data-longpress-action="additionalKeys" style="top: 0%; left: 7.79221%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 100%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="Digit2" data-key="2" data-shift-key="2" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">2</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default">w</span>
                            <span class="tchmi-keyboard-template-label show-shift">W</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyE" data-key="e" data-shift-key="E" data-longpress-action="additionalKeys" style="top: 0%; left: 15.5844%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: -120%; width: 580%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="Digit3" data-key="3" data-shift-key="3" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">3</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyE" data-key="€" data-shift-key="€" style="top: -120%; left: -120%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">€</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyE" data-key="ê" data-shift-key="Ê" style="top: -120%; left: 120%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default">ê</span>
                                <span class="tchmi-keyboard-template-label show-shift">Ê</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyE" data-key="é" data-shift-key="É" style="top: -120%; left: 240%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default">é</span>
                                <span class="tchmi-keyboard-template-label show-shift">É</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyE" data-key="è" data-shift-key="È" style="top: -120%; left: 360%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default">è</span>
                                <span class="tchmi-keyboard-template-label show-shift">È</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default">e</span>
                            <span class="tchmi-keyboard-template-label show-shift">E</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyR" data-key="r" data-shift-key="R" data-longpress-action="additionalKeys" style="top: 0%; left: 23.3766%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 100%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="Digit4" data-key="4" data-shift-key="4" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">4</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default">r</span>
                            <span class="tchmi-keyboard-template-label show-shift">R</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyT" data-key="t" data-shift-key="T" data-longpress-action="additionalKeys" style="top: 0%; left: 31.1688%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 100%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="Digit5" data-key="5" data-shift-key="5" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">5</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default">t</span>
                            <span class="tchmi-keyboard-template-label show-shift">T</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyY" data-key="z" data-shift-key="Z" data-longpress-action="additionalKeys" style="top: 0%; left: 38.961%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 100%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="Digit6" data-key="6" data-shift-key="6" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">6</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default">z</span>
                            <span class="tchmi-keyboard-template-label show-shift">Z</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyU" data-key="u" data-shift-key="U" data-longpress-action="additionalKeys" style="top: 0%; left: 46.7532%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 460%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="Digit7" data-key="7" data-shift-key="7" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">7</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyU" data-key="û" data-shift-key="Û" style="top: -120%; left: 120%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default">û</span>
                                <span class="tchmi-keyboard-template-label show-shift">Û</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyU" data-key="ú" data-shift-key="Ú" style="top: -120%; left: 240%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default">ú</span>
                                <span class="tchmi-keyboard-template-label show-shift">Ú</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyU" data-key="ù" data-shift-key="Ù" style="top: -120%; left: 360%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default">ù</span>
                                <span class="tchmi-keyboard-template-label show-shift">Ù</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default">u</span>
                            <span class="tchmi-keyboard-template-label show-shift">U</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyI" data-key="i" data-shift-key="I" data-longpress-action="additionalKeys" style="top: 0%; left: 54.5455%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 460%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="Digit8" data-key="8" data-shift-key="8" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">8</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyI" data-key="î" data-shift-key="Î" style="top: -120%; left: 120%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default">î</span>
                                <span class="tchmi-keyboard-template-label show-shift">Î</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyI" data-key="í" data-shift-key="Í" style="top: -120%; left: 240%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default">í</span>
                                <span class="tchmi-keyboard-template-label show-shift">Í</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyI" data-key="ì" data-shift-key="Ì" style="top: -120%; left: 360%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default">ì</span>
                                <span class="tchmi-keyboard-template-label show-shift">Ì</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default">i</span>
                            <span class="tchmi-keyboard-template-label show-shift">I</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyO" data-key="o" data-shift-key="O" data-longpress-action="additionalKeys" style="top: 0%; left: 62.3377%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 460%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="Digit9" data-key="9" data-shift-key="9" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">9</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyO" data-key="ô" data-shift-key="Ô" style="top: -120%; left: 120%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default">ô</span>
                                <span class="tchmi-keyboard-template-label show-shift">Ô</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyO" data-key="ó" data-shift-key="Ó" style="top: -120%; left: 240%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default">ó</span>
                                <span class="tchmi-keyboard-template-label show-shift">Ó</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyO" data-key="ò" data-shift-key="Ò" style="top: -120%; left: 360%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default">ò</span>
                                <span class="tchmi-keyboard-template-label show-shift">Ò</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default">o</span>
                            <span class="tchmi-keyboard-template-label show-shift">O</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyP" data-key="p" data-shift-key="P" data-longpress-action="additionalKeys" style="top: 0%; left: 70.1299%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 100%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="Digit0" data-key="0" data-shift-key="0" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">0</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default">p</span>
                            <span class="tchmi-keyboard-template-label show-shift">P</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="BracketLeft" data-key="ü" data-shift-key="Ü" style="top: 0%; left: 77.9221%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default">ü</span>
                            <span class="tchmi-keyboard-template-label show-shift">Ü</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyA" data-key="a" data-shift-key="A" data-longpress-action="additionalKeys" style="top: 26.087%; left: 2.5974%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 340%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyA" data-key="â" data-shift-key="Â" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default">â</span>
                                <span class="tchmi-keyboard-template-label show-shift">Â</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyA" data-key="á" data-shift-key="Á" style="top: -120%; left: 120%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default">á</span>
                                <span class="tchmi-keyboard-template-label show-shift">Á</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyA" data-key="à" data-shift-key="À" style="top: -120%; left: 240%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default">à</span>
                                <span class="tchmi-keyboard-template-label show-shift">À</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default">a</span>
                            <span class="tchmi-keyboard-template-label show-shift">A</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyS" data-key="s" data-shift-key="S" data-longpress-action="additionalKeys" style="top: 26.087%; left: 10.3896%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 100%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyS" data-key="ß" data-shift-key="ß" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">ß</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default">s</span>
                            <span class="tchmi-keyboard-template-label show-shift">S</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyD" data-key="d" data-shift-key="D" style="top: 26.087%; left: 18.1818%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default">d</span>
                            <span class="tchmi-keyboard-template-label show-shift">D</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyF" data-key="f" data-shift-key="F" style="top: 26.087%; left: 25.974%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default">f</span>
                            <span class="tchmi-keyboard-template-label show-shift">F</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyG" data-key="g" data-shift-key="G" style="top: 26.087%; left: 33.7662%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default">g</span>
                            <span class="tchmi-keyboard-template-label show-shift">G</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyH" data-key="h" data-shift-key="H" style="top: 26.087%; left: 41.5584%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default">h</span>
                            <span class="tchmi-keyboard-template-label show-shift">H</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyJ" data-key="j" data-shift-key="J" style="top: 26.087%; left: 49.3506%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default">j</span>
                            <span class="tchmi-keyboard-template-label show-shift">J</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyK" data-key="k" data-shift-key="K" style="top: 26.087%; left: 57.1429%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default">k</span>
                            <span class="tchmi-keyboard-template-label show-shift">K</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyL" data-key="l" data-shift-key="L" style="top: 26.087%; left: 64.9351%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default">l</span>
                            <span class="tchmi-keyboard-template-label show-shift">L</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Semicolon" data-key="ö" data-shift-key="Ö" style="top: 26.087%; left: 72.7273%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default">ö</span>
                            <span class="tchmi-keyboard-template-label show-shift">Ö</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Quote" data-key="ä" data-shift-key="Ä" style="top: 26.087%; left: 80.5195%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default">ä</span>
                            <span class="tchmi-keyboard-template-label show-shift">Ä</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyZ" data-key="y" data-shift-key="Y" data-longpress-action="additionalKeys" style="top: 52.1739%; left: 7.79221%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 100%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyZ" data-key="ý" data-shift-key="Ý" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default">ý</span>
                                <span class="tchmi-keyboard-template-label show-shift">Ý</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default">y</span>
                            <span class="tchmi-keyboard-template-label show-shift">Y</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyX" data-key="x" data-shift-key="X" style="top: 52.1739%; left: 15.5844%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default">x</span>
                            <span class="tchmi-keyboard-template-label show-shift">X</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyC" data-key="c" data-shift-key="C" style="top: 52.1739%; left: 23.3766%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default">c</span>
                            <span class="tchmi-keyboard-template-label show-shift">C</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyV" data-key="v" data-shift-key="V" style="top: 52.1739%; left: 31.1688%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default">v</span>
                            <span class="tchmi-keyboard-template-label show-shift">V</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyB" data-key="b" data-shift-key="B" style="top: 52.1739%; left: 38.961%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default">b</span>
                            <span class="tchmi-keyboard-template-label show-shift">B</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyN" data-key="n" data-shift-key="N" style="top: 52.1739%; left: 46.7532%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default">n</span>
                            <span class="tchmi-keyboard-template-label show-shift">N</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyM" data-key="m" data-shift-key="M" data-longpress-action="additionalKeys" style="top: 52.1739%; left: 54.5455%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 100%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyM" data-key="µ" data-shift-key="µ" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">µ</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default">m</span>
                            <span class="tchmi-keyboard-template-label show-shift">M</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Comma" data-key="," data-shift-key=";" style="top: 52.1739%; left: 62.3377%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default">,</span>
                            <span class="tchmi-keyboard-template-label show-shift">;</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Period" data-key="." data-shift-key=":" style="top: 52.1739%; left: 70.1299%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default">.</span>
                            <span class="tchmi-keyboard-template-label show-shift">:</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Minus" data-key="-" data-shift-key="_" style="top: 78.2609%; left: 15.5844%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default">-</span>
                            <span class="tchmi-keyboard-template-label show-shift">_</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Slash" data-key="/" data-shift-key="\" style="top: 78.2609%; left: 7.79221%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default">/</span>
                            <span class="tchmi-keyboard-template-label show-shift">\</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="IntlBackslash" data-key="?" data-shift-key="!" style="top: 52.1739%; left: 77.9221%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default">?</span>
                            <span class="tchmi-keyboard-template-label show-shift">!</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Space" data-key=" " data-ignore-modifiers="true" style="top: 78.2609%; left: 23.3766%; width: 45.4545%; height: 21.7391%;"></div>
                        <div class="tchmi-keyboard-template-key" data-code="Backspace" data-key="Backspace" data-type="action" data-longpress-action="repeat" style="top: 0%; left: 85.7143%; width: 14.2857%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="22" height="14">
                                    <path d="M 0.5 7 L 7 0.5 L 21.5 0.5 L 21.5 13.5 L 7 13.5 Z M 10 3 L 18 11 M 10 11 L 18 3" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Enter" data-key="Enter" data-no-caps-lock="false" data-ignore-modifiers="true" style="top: 26.087%; left: 88.3117%; width: 11.6883%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="22" height="14">
                                    <path d="M 21.5 8.5 L 21.5 0.5 L 21.5 8.5 L 5.5 8.5 M 5.5 3.5 L 0.5 8.5 L 5.5 13.5" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="ShiftLeft" data-key="Shift" data-type="modifier" data-mode="sticky" data-location="left" style="top: 52.1739%; left: 0%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="14" height="14">
                                    <path d="M 3.5 13.5 L 3.5 6.5 L 0.5 6.5 L 7 0.5 L 13.5 6.5 L 10.5 6.5 L 10.5 13.5 Z" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="ShiftRight" data-key="Shift" data-type="modifier" data-mode="sticky" data-location="right" style="top: 52.1739%; left: 85.7143%; width: 14.2857%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="14" height="14">
                                    <path d="M 3.5 13.5 L 3.5 6.5 L 0.5 6.5 L 7 0.5 L 13.5 6.5 L 10.5 6.5 L 10.5 13.5 Z" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="ArrowLeft" data-key="ArrowLeft" data-type="action" data-longpress-action="repeat" style="top: 78.2609%; left: 70.1299%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="7" height="14">
                                    <path d="M 6.5 0.5 L 0.5 7 L 6.5 13.5" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="ArrowRight" data-key="ArrowRight" data-type="action" data-longpress-action="repeat" style="top: 78.2609%; left: 77.9221%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="7" height="14">
                                    <path d="M 0.5 0.5 L 6.5 7 L 0.5 13.5" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="ArrowUp" data-key="ArrowUp" data-type="action" data-longpress-action="repeat" style="top: 78.2609%; left: 85.7143%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="14" height="7">
                                    <path d="M 0.5 6.5 L 7 0.5 L 13.5 6.5" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="ArrowDown" data-key="ArrowDown" data-type="action" data-longpress-action="repeat" style="top: 78.2609%; left: 93.5065%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="14" height="7">
                                    <path d="M 0.5 0.5 L 7 6.5 L 13.5 0.5" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="" data-key="" data-type="layout-switch" data-layout-name="numbersAndSymbols" style="top: 78.2609%; left: 0%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">123+</span>
                        </div>
                    </div>

                    <div class="tchmi-keyboard-template-layout en-us_qwerty" data-width="770" data-height="230" style="display: none;">
                        <div class="tchmi-keyboard-template-key" data-code="KeyQ" data-key="q" data-shift-key="Q" data-longpress-action="additionalKeys" style="top: 0%; left: 0%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 220%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="Digit1" data-key="1" data-shift-key="1" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">1</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyQ" data-key="@" data-shift-key="@" style="top: -120%; left: 120%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">@</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">q</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">Q</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyW" data-key="w" data-shift-key="W" data-longpress-action="additionalKeys" style="top: 0%; left: 7.79221%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 100%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="Digit2" data-key="2" data-shift-key="2" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">2</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">w</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">W</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyE" data-key="e" data-shift-key="E" data-longpress-action="additionalKeys" style="top: 0%; left: 15.5844%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: -120%; width: 580%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="Digit3" data-key="3" data-shift-key="3" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">3</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyE" data-key="€" data-shift-key="€" style="top: -120%; left: -120%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">€</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyE" data-key="ê" data-shift-key="Ê" style="top: -120%; left: 120%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">ê</span>
                                <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">Ê</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyE" data-key="é" data-shift-key="É" style="top: -120%; left: 240%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">é</span>
                                <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">É</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyE" data-key="è" data-shift-key="È" style="top: -120%; left: 360%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">è</span>
                                <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">È</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">e</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">E</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyR" data-key="r" data-shift-key="R" data-longpress-action="additionalKeys" style="top: 0%; left: 23.3766%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 100%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="Digit4" data-key="4" data-shift-key="4" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">4</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">r</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">R</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyT" data-key="t" data-shift-key="T" data-longpress-action="additionalKeys" style="top: 0%; left: 31.1688%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 100%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="Digit5" data-key="5" data-shift-key="5" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">5</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">t</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">T</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyY" data-key="y" data-shift-key="Y" data-longpress-action="additionalKeys" style="top: 0%; left: 38.961%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 220%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="Digit6" data-key="6" data-shift-key="6" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">6</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyY" data-key="ý" data-shift-key="Ý" style="top: -120%; left: 120%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">ý</span>
                                <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">Ý</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">y</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">Y</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyU" data-key="u" data-shift-key="U" data-longpress-action="additionalKeys" style="top: 0%; left: 46.7532%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 580%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="Digit7" data-key="7" data-shift-key="7" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">7</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyU" data-key="ü" data-shift-key="Ü" style="top: -120%; left: 120%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">ü</span>
                                <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">Ü</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyU" data-key="û" data-shift-key="Û" style="top: -120%; left: 240%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">û</span>
                                <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">Û</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyU" data-key="ú" data-shift-key="Ú" style="top: -120%; left: 360%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">ú</span>
                                <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">Ú</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyU" data-key="ù" data-shift-key="Ù" style="top: -120%; left: 480%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">ù</span>
                                <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">Ù</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">u</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">U</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyI" data-key="i" data-shift-key="I" data-longpress-action="additionalKeys" style="top: 0%; left: 54.5455%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 460%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="Digit8" data-key="8" data-shift-key="8" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">8</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyI" data-key="î" data-shift-key="Î" style="top: -120%; left: 120%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">î</span>
                                <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">Î</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyI" data-key="í" data-shift-key="Í" style="top: -120%; left: 240%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">í</span>
                                <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">Í</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyI" data-key="ì" data-shift-key="Ì" style="top: -120%; left: 360%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">ì</span>
                                <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">Ì</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">i</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">I</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyO" data-key="o" data-shift-key="O" data-longpress-action="additionalKeys" style="top: 0%; left: 62.3377%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 580%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="Digit9" data-key="9" data-shift-key="9" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">9</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyO" data-key="ö" data-shift-key="Ö" style="top: -120%; left: 120%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">ö</span>
                                <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">Ö</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyO" data-key="ô" data-shift-key="Ô" style="top: -120%; left: 240%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">ô</span>
                                <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">Ô</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyO" data-key="ó" data-shift-key="Ó" style="top: -120%; left: 360%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">ó</span>
                                <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">Ó</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyO" data-key="ò" data-shift-key="Ò" style="top: -120%; left: 480%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">ò</span>
                                <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">Ò</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">o</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">O</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyP" data-key="p" data-shift-key="P" data-longpress-action="additionalKeys" style="top: 0%; left: 70.1299%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 100%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="Digit0" data-key="0" data-shift-key="0" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">0</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">p</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">P</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Quote" data-key="'" data-shift-key="&quot;" style="top: 0%; left: 77.9221%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">'</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">"</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyA" data-key="a" data-shift-key="A" data-longpress-action="additionalKeys" style="top: 26.087%; left: 2.5974%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 460%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyA" data-key="ä" data-shift-key="Ä" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">ä</span>
                                <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">Ä</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyA" data-key="â" data-shift-key="Â" style="top: -120%; left: 120%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">â</span>
                                <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">Â</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyA" data-key="á" data-shift-key="Á" style="top: -120%; left: 240%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">á</span>
                                <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">Á</span>
                            </div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyA" data-key="à" data-shift-key="À" style="top: -120%; left: 360%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">à</span>
                                <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">À</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">a</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">A</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyS" data-key="s" data-shift-key="S" data-longpress-action="additionalKeys" style="top: 26.087%; left: 10.3896%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 100%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyS" data-key="ß" data-shift-key="ß" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">ß</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">s</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">S</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyD" data-key="d" data-shift-key="D" style="top: 26.087%; left: 18.1818%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">d</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">D</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyF" data-key="f" data-shift-key="F" style="top: 26.087%; left: 25.974%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">f</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">F</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyG" data-key="g" data-shift-key="G" style="top: 26.087%; left: 33.7662%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">g</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">G</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyH" data-key="h" data-shift-key="H" style="top: 26.087%; left: 41.5584%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">h</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">H</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyJ" data-key="j" data-shift-key="J" style="top: 26.087%; left: 49.3506%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">j</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">J</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyK" data-key="k" data-shift-key="K" style="top: 26.087%; left: 57.1429%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">k</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">K</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyL" data-key="l" data-shift-key="L" style="top: 26.087%; left: 64.9351%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">l</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">L</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="BracketLeft" data-key="(" data-shift-key="[" style="top: 26.087%; left: 72.7273%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">(</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">[</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="BracketRight" data-key=")" data-shift-key="]" style="top: 26.087%; left: 80.5195%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">)</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">]</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyZ" data-key="z" data-shift-key="Z" style="top: 52.1739%; left: 7.79221%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">z</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">Z</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyX" data-key="x" data-shift-key="X" style="top: 52.1739%; left: 15.5844%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">x</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">X</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyC" data-key="c" data-shift-key="C" style="top: 52.1739%; left: 23.3766%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">c</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">C</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyV" data-key="v" data-shift-key="V" style="top: 52.1739%; left: 31.1688%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">v</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">V</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyB" data-key="b" data-shift-key="B" style="top: 52.1739%; left: 38.961%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">b</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">B</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyN" data-key="n" data-shift-key="N" style="top: 52.1739%; left: 46.7532%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">n</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">N</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="KeyM" data-key="m" data-shift-key="M" data-longpress-action="additionalKeys" style="top: 52.1739%; left: 54.5455%; width: 6.49351%; height: 21.7391%;">
                            <div class="tchmi-keyboard-template-backdrop" style="top: -120%; left: 0%; width: 100%; height: 100%;"></div>
                            <div class="tchmi-keyboard-template-key additional-key" data-code="KeyM" data-key="µ" data-shift-key="µ" style="top: -120%; left: 0%; width: 100%; height: 100%;">
                                <span class="tchmi-keyboard-template-label show-always">µ</span>
                            </div>
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">m</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">M</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Comma" data-key="," data-shift-key=";" style="top: 52.1739%; left: 62.3377%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">,</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">;</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Period" data-key="." data-shift-key=":" style="top: 52.1739%; left: 70.1299%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">.</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">:</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Minus" data-key="-" data-shift-key="_" style="top: 78.2609%; left: 15.5844%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">-</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">_</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Slash" data-key="/" data-shift-key="\" style="top: 78.2609%; left: 7.79221%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">/</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">\</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="IntlBackslash" data-key="?" data-shift-key="!" style="top: 52.1739%; left: 77.9221%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-default" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">?</span>
                            <span class="tchmi-keyboard-template-label show-shift" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">!</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Space" data-key=" " data-ignore-modifiers="true" style="top: 78.2609%; left: 23.3766%; width: 45.4545%; height: 21.7391%;"></div>
                        <div class="tchmi-keyboard-template-key" data-code="Backspace" data-key="Backspace" data-type="action" data-longpress-action="repeat" style="top: 0%; left: 85.7143%; width: 14.2857%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="22" height="14">
                                    <path d="M 0.5 7 L 7 0.5 L 21.5 0.5 L 21.5 13.5 L 7 13.5 Z M 10 3 L 18 11 M 10 11 L 18 3" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Enter" data-key="Enter" data-no-caps-lock="false" data-ignore-modifiers="true" style="top: 26.087%; left: 88.3117%; width: 11.6883%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="22" height="14">
                                    <path d="M 21.5 8.5 L 21.5 0.5 L 21.5 8.5 L 5.5 8.5 M 5.5 3.5 L 0.5 8.5 L 5.5 13.5" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="ShiftLeft" data-key="Shift" data-type="modifier" data-mode="sticky" data-location="left" style="top: 52.1739%; left: 0%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="14" height="14">
                                    <path d="M 3.5 13.5 L 3.5 6.5 L 0.5 6.5 L 7 0.5 L 13.5 6.5 L 10.5 6.5 L 10.5 13.5 Z" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="ShiftRight" data-key="Shift" data-type="modifier" data-mode="sticky" data-location="right" style="top: 52.1739%; left: 85.7143%; width: 14.2857%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="14" height="14">
                                    <path d="M 3.5 13.5 L 3.5 6.5 L 0.5 6.5 L 7 0.5 L 13.5 6.5 L 10.5 6.5 L 10.5 13.5 Z" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="ArrowLeft" data-key="ArrowLeft" data-type="action" data-longpress-action="repeat" style="top: 78.2609%; left: 70.1299%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="7" height="14">
                                    <path d="M 6.5 0.5 L 0.5 7 L 6.5 13.5" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="ArrowRight" data-key="ArrowRight" data-type="action" data-longpress-action="repeat" style="top: 78.2609%; left: 77.9221%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="7" height="14">
                                    <path d="M 0.5 0.5 L 6.5 7 L 0.5 13.5" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="ArrowUp" data-key="ArrowUp" data-type="action" data-longpress-action="repeat" style="top: 78.2609%; left: 85.7143%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="14" height="7">
                                    <path d="M 0.5 6.5 L 7 0.5 L 13.5 6.5" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="ArrowDown" data-key="ArrowDown" data-type="action" data-longpress-action="repeat" style="top: 78.2609%; left: 93.5065%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="14" height="7">
                                    <path d="M 0.5 0.5 L 7 6.5 L 13.5 0.5" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="" data-key="" data-type="layout-switch" data-layout-name="numbersAndSymbols" style="top: 78.2609%; left: 0%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">123+</span>
                        </div>
                    </div>

                    <div class="tchmi-keyboard-template-layout numbersAndSymbols" data-width="770" data-height="230" style="display: none;">
                        <div class="tchmi-keyboard-template-key" data-code="Backspace" data-key="Backspace" data-type="action" data-longpress-action="repeat" data-ignore-modifiers="true" style="top: 0%; left: 85.7143%; width: 14.2857%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="22" height="14">
                                    <path d="M 0.5 7 L 7 0.5 L 21.5 0.5 L 21.5 13.5 L 7 13.5 Z M 10 3 L 18 11 M 10 11 L 18 3" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="NumpadEnter" data-key="Enter" data-location="numpad" data-ignore-modifiers="true" style="top: 26.087%; left: 85.7143%; width: 14.2857%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="22" height="14">
                                    <path d="M 21.5 8.5 L 21.5 0.5 L 21.5 8.5 L 5.5 8.5 M 5.5 3.5 L 0.5 8.5 L 5.5 13.5" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="ArrowLeft" data-key="ArrowLeft" data-type="action" data-longpress-action="repeat" data-ignore-modifiers="true" style="top: 52.1739%; left: 85.7143%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="7" height="14">
                                    <path d="M 6.5 0.5 L 0.5 7 L 6.5 13.5" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="ArrowRight" data-key="ArrowRight" data-type="action" data-longpress-action="repeat" data-ignore-modifiers="true" style="top: 52.1739%; left: 93.5065%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="7" height="14">
                                    <path d="M 0.5 0.5 L 6.5 7 L 0.5 13.5" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="ArrowUp" data-key="ArrowUp" data-type="action" data-longpress-action="repeat" data-ignore-modifiers="true" style="top: 78.2609%; left: 85.7143%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="14" height="7">
                                    <path d="M 0.5 6.5 L 7 0.5 L 13.5 6.5" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="ArrowDown" data-key="ArrowDown" data-type="action" data-longpress-action="repeat" data-ignore-modifiers="true" style="top: 78.2609%; left: 93.5065%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="14" height="7">
                                    <path d="M 0.5 0.5 L 7 6.5 L 13.5 0.5" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="" data-key="" data-type="layout-switch" data-layout-name="default" style="top: 78.2609%; left: 0%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">ABC</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Numpad1" data-key="1" data-location="numpad" data-ignore-modifiers="true" style="top: 0%; left: 58.4416%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">1</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Numpad2" data-key="2" data-location="numpad" data-ignore-modifiers="true" style="top: 0%; left: 66.2338%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">2</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Numpad3" data-key="3" data-location="numpad" data-ignore-modifiers="true" style="top: 0%; left: 74.026%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">3</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Numpad4" data-key="4" data-location="numpad" data-ignore-modifiers="true" style="top: 26.087%; left: 58.4416%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">4</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Numpad5" data-key="5" data-location="numpad" data-ignore-modifiers="true" style="top: 26.087%; left: 66.2338%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">5</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Numpad6" data-key="6" data-location="numpad" data-ignore-modifiers="true" style="top: 26.087%; left: 74.026%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">6</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Numpad7" data-key="7" data-location="numpad" data-ignore-modifiers="true" style="top: 52.1739%; left: 58.4416%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">7</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Numpad8" data-key="8" data-location="numpad" data-ignore-modifiers="true" style="top: 52.1739%; left: 66.2338%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">8</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Numpad9" data-key="9" data-location="numpad" data-ignore-modifiers="true" style="top: 52.1739%; left: 74.026%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">9</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Numpad0" data-key="0" data-location="numpad" data-ignore-modifiers="true" style="top: 78.2609%; left: 66.2338%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">0</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="NumpadDecimal" data-key="," data-location="numpad" data-ignore-modifiers="true" style="top: 78.2609%; left: 58.4416%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">,</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="NumpadDecimal" data-key="." data-location="numpad" data-ignore-modifiers="true" style="top: 78.2609%; left: 74.026%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">.</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="NumpadAdd" data-key="+" data-location="numpad" data-ignore-modifiers="true" style="top: 0%; left: 46.7532%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">+</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="NumpadSubtract" data-key="-" data-location="numpad" data-ignore-modifiers="true" style="top: 26.087%; left: 46.7532%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">-</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="NumpadMultiply" data-key="×" data-location="numpad" data-ignore-modifiers="true" style="top: 52.1739%; left: 46.7532%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">×</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="NumpadDivide" data-key="÷" data-location="numpad" data-ignore-modifiers="true" style="top: 78.2609%; left: 46.7532%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">÷</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="NumpadDivide" data-key="/" data-location="numpad" data-ignore-modifiers="true" style="top: 78.2609%; left: 38.961%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">/</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="IntlBackslash" data-key="\" data-ignore-modifiers="true" style="top: 78.2609%; left: 31.1688%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">\</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="NumpadMultiply" data-key="*" data-location="numpad" data-ignore-modifiers="true" style="top: 52.1739%; left: 38.961%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">*</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Ampersand" data-key="&amp;" data-ignore-modifiers="true" style="top: 0%; left: 38.961%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">&amp;</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Equal" data-key="=" data-ignore-modifiers="true" style="top: 26.087%; left: 38.961%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">=</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Percent" data-key="%" data-ignore-modifiers="true" style="top: 0%; left: 31.1688%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">%</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Quote" data-key="&quot;" data-ignore-modifiers="true" style="top: 26.087%; left: 31.1688%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">"</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Quote" data-key="'" data-ignore-modifiers="true" style="top: 52.1739%; left: 31.1688%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">'</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="BracketRight" data-key=")" data-ignore-modifiers="true" style="top: 0%; left: 23.3766%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">)</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="BracketLeft" data-key="(" data-ignore-modifiers="true" style="top: 0%; left: 15.5844%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">(</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="BracketLeft" data-key="[" data-ignore-modifiers="true" style="top: 26.087%; left: 15.5844%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">[</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="BracketRight" data-key="]" data-ignore-modifiers="true" style="top: 26.087%; left: 23.3766%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">]</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="BracketLeft" data-key="{" data-ignore-modifiers="true" style="top: 52.1739%; left: 15.5844%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">{</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="BracketRight" data-key="}" data-ignore-modifiers="true" style="top: 52.1739%; left: 23.3766%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">}</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Pound" data-key="£" data-ignore-modifiers="true" style="top: 0%; left: 0%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">£</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Yen" data-key="¥" data-ignore-modifiers="true" style="top: 0%; left: 7.79221%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">¥</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Euro" data-key="€" data-ignore-modifiers="true" style="top: 26.087%; left: 0%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">€</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Dollar" data-key="$" data-ignore-modifiers="true" style="top: 26.087%; left: 7.79221%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">$</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="At" data-key="@" data-ignore-modifiers="true" style="top: 52.1739%; left: 7.79221%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">@</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Space" data-key=" " data-ignore-modifiers="true" style="top: 78.2609%; left: 7.79221%; width: 22.0779%; height: 21.7391%;"></div>
                        <div class="tchmi-keyboard-template-key" data-code="" data-key="" data-type="layout-switch" data-layout-name="numbersAndSymbols2" style="top: 52.1739%; left: 0%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">§Σ√</span>
                        </div>
                    </div>

                    <div class="tchmi-keyboard-template-layout numbersAndSymbols2" data-width="770" data-height="230" style="display: none;">
                        <div class="tchmi-keyboard-template-key" data-code="Backspace" data-key="Backspace" data-type="action" data-longpress-action="repeat" data-ignore-modifiers="true" style="top: 0%; left: 85.7143%; width: 14.2857%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="22" height="14">
                                    <path d="M 0.5 7 L 7 0.5 L 21.5 0.5 L 21.5 13.5 L 7 13.5 Z M 10 3 L 18 11 M 10 11 L 18 3" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="NumpadEnter" data-key="Enter" data-location="numpad" data-ignore-modifiers="true" style="top: 26.087%; left: 85.7143%; width: 14.2857%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="22" height="14">
                                    <path d="M 21.5 8.5 L 21.5 0.5 L 21.5 8.5 L 5.5 8.5 M 5.5 3.5 L 0.5 8.5 L 5.5 13.5" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="ArrowLeft" data-key="ArrowLeft" data-type="action" data-longpress-action="repeat" data-ignore-modifiers="true" style="top: 52.1739%; left: 85.7143%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="7" height="14">
                                    <path d="M 6.5 0.5 L 0.5 7 L 6.5 13.5" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="ArrowRight" data-key="ArrowRight" data-type="action" data-longpress-action="repeat" data-ignore-modifiers="true" style="top: 52.1739%; left: 93.5065%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="7" height="14">
                                    <path d="M 0.5 0.5 L 6.5 7 L 0.5 13.5" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="ArrowUp" data-key="ArrowUp" data-type="action" data-longpress-action="repeat" data-ignore-modifiers="true" style="top: 78.2609%; left: 85.7143%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="14" height="7">
                                    <path d="M 0.5 6.5 L 7 0.5 L 13.5 6.5" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="ArrowDown" data-key="ArrowDown" data-type="action" data-longpress-action="repeat" data-ignore-modifiers="true" style="top: 78.2609%; left: 93.5065%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always" style="top: 4px; right: 4px; bottom: 4px; left: 4px;">
                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="14" height="7">
                                    <path d="M 0.5 0.5 L 7 6.5 L 13.5 0.5" />
                                </svg>
                            </span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="" data-key="" data-type="layout-switch" data-layout-name="default" style="top: 78.2609%; left: 0%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">ABC</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Numpad1" data-key="1" data-location="numpad" data-ignore-modifiers="true" style="top: 0%; left: 58.4416%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">1</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Numpad2" data-key="2" data-location="numpad" data-ignore-modifiers="true" style="top: 0%; left: 66.2338%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">2</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Numpad3" data-key="3" data-location="numpad" data-ignore-modifiers="true" style="top: 0%; left: 74.026%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">3</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Numpad4" data-key="4" data-location="numpad" data-ignore-modifiers="true" style="top: 26.087%; left: 58.4416%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">4</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Numpad5" data-key="5" data-location="numpad" data-ignore-modifiers="true" style="top: 26.087%; left: 66.2338%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">5</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Numpad6" data-key="6" data-location="numpad" data-ignore-modifiers="true" style="top: 26.087%; left: 74.026%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">6</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Numpad7" data-key="7" data-location="numpad" data-ignore-modifiers="true" style="top: 52.1739%; left: 58.4416%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">7</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Numpad8" data-key="8" data-location="numpad" data-ignore-modifiers="true" style="top: 52.1739%; left: 66.2338%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">8</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Numpad9" data-key="9" data-location="numpad" data-ignore-modifiers="true" style="top: 52.1739%; left: 74.026%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">9</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Numpad0" data-key="0" data-location="numpad" data-ignore-modifiers="true" style="top: 78.2609%; left: 66.2338%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">0</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="NumpadDecimal" data-key="," data-location="numpad" data-ignore-modifiers="true" style="top: 78.2609%; left: 58.4416%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">,</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="NumpadDecimal" data-key="." data-location="numpad" data-ignore-modifiers="true" style="top: 78.2609%; left: 74.026%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">.</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Hat" data-key="^" data-ignore-modifiers="true" style="top: 0%; left: 46.7532%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">^</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Cubed" data-key="³" data-ignore-modifiers="true" style="top: 26.087%; left: 46.7532%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">³</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Diameter" data-key="⌀" data-ignore-modifiers="true" style="top: 52.1739%; left: 46.7532%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">⌀</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Trademark" data-key="™" data-ignore-modifiers="true" style="top: 78.2609%; left: 46.7532%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">™</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="RegisteredTrademark" data-key="®" data-ignore-modifiers="true" style="top: 78.2609%; left: 38.961%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">®</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Copyright" data-key="©" data-ignore-modifiers="true" style="top: 78.2609%; left: 31.1688%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">©</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Pi" data-key="π" data-ignore-modifiers="true" style="top: 52.1739%; left: 38.961%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">π</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Degrees" data-key="°" data-ignore-modifiers="true" style="top: 0%; left: 38.961%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">°</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Squared" data-key="²" data-ignore-modifiers="true" style="top: 26.087%; left: 38.961%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">²</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Hash" data-key="#" data-ignore-modifiers="true" style="top: 0%; left: 31.1688%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">#</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Root" data-key="√" data-ignore-modifiers="true" style="top: 26.087%; left: 31.1688%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">√</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Sum" data-key="Σ" data-ignore-modifiers="true" style="top: 52.1739%; left: 31.1688%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">Σ</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="GreaterThan" data-key=">" data-ignore-modifiers="true" style="top: 0%; left: 23.3766%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">&gt;</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="LessThan" data-key="<" data-ignore-modifiers="true" style="top: 0%; left: 15.5844%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">&lt;</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="LessThanOrEqual" data-key="≤" data-ignore-modifiers="true" style="top: 26.087%; left: 15.5844%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">≤</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="GreaterThanOrEqual" data-key="≥" data-ignore-modifiers="true" style="top: 26.087%; left: 23.3766%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">≥</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Backtick" data-key="`" data-ignore-modifiers="true" style="top: 52.1739%; left: 15.5844%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">`</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Tick" data-key="´" data-ignore-modifiers="true" style="top: 52.1739%; left: 23.3766%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">´</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Cent" data-key="¢" data-ignore-modifiers="true" style="top: 0%; left: 0%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">¢</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Promille" data-key="‰" data-ignore-modifiers="true" style="top: 0%; left: 7.79221%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">‰</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Tilde" data-key="~" data-ignore-modifiers="true" style="top: 26.087%; left: 0%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">~</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Paragraph" data-key="§" data-ignore-modifiers="true" style="top: 26.087%; left: 7.79221%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">§</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Pipe" data-key="|" data-ignore-modifiers="true" style="top: 52.1739%; left: 7.79221%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">|</span>
                        </div>
                        <div class="tchmi-keyboard-template-key" data-code="Space" data-key=" " data-ignore-modifiers="true" style="top: 78.2609%; left: 7.79221%; width: 22.0779%; height: 21.7391%;"></div>
                        <div class="tchmi-keyboard-template-key" data-code="" data-key="" data-type="layout-switch" data-layout-name="numbersAndSymbols" style="top: 52.1739%; left: 0%; width: 6.49351%; height: 21.7391%;">
                            <span class="tchmi-keyboard-template-label show-always">123+</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- #endregion -->
    <!-- #region Styles for keyboard
        ##################################
        Do not make any changes here
        -->
    <style>
        .keyboardcontainer {
            margin-bottom: 0;
            transition: margin-bottom 0.5s;
            width: 100%;
            max-width: 792px;
            align-self: center;
            z-index: 150;
            position: relative;
            bottom: 0;
        }

        .keyboard-toggle {
            position: absolute;
            right: 0;
            top: -48px;
            width: 50px;
            height: 49px;
            border: 1px solid #666666;
            border-bottom: none;
            background-color: #D9DEE2;
            padding: 10px;
            box-sizing: border-box;
        }

            .keyboard-toggle svg {
                fill: none;
                stroke: #666666;
                stroke-width: 1px;
            }

        .keyboardcontainer .shown-icon {
            opacity: 1;
            transition: opacity 0.5s;
        }

        .keyboardcontainer .hidden-icon {
            opacity: 0;
            transition: opacity 0.5s;
        }

        .keyboardcontainer.hidden .shown-icon {
            opacity: 0;
        }

        .keyboardcontainer.hidden .hidden-icon {
            opacity: 1;
        }

        .tchmi-keyboard {
            padding: 10px;
            border: 1px solid #666;
            border-bottom: none;
            background-color: #D9DEE2;
        }

        .tchmi-keyboard-template {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .tchmi-keyboard-template-padding-container {
            width: 100%;
            height: 100%;
            position: relative;
        }

        .tchmi-keyboard-template-key {
            position: absolute;
            background-image: linear-gradient(135deg, #eff1f3, #aeb9c2);
            color: #4794da;
            box-shadow: 0px 0px 5px 0px rgba(0,0,0,0.6);
            box-sizing: border-box;
        }

            .tchmi-keyboard-template-key .tchmi-keyboard-template-key.additional-key {
                display: none;
                box-sizing: content-box;
            }

            .tchmi-keyboard-template-key.show-additional-keys .tchmi-keyboard-template-key.additional-key {
                display: block;
            }

            .tchmi-keyboard-template-key .tchmi-keyboard-template-backdrop {
                pointer-events: none;
                visibility: hidden;
                position: absolute;
                padding: 8px;
                transform: translate(-8px, -8px);
                border: 1px solid #007ACC;
                background: #FFFFFF;
                background: linear-gradient(135deg, #eff1f3, #aeb9c2);
                color: #4794da;
                box-shadow: 0px 0px 5px 0px rgba(0,0,0,0.6);
            }

            .tchmi-keyboard-template-key.show-additional-keys .tchmi-keyboard-template-backdrop {
                visibility: visible;
            }

            .tchmi-keyboard-template-key.show-additional-keys {
                background: linear-gradient(135deg, #aeb9c2, #eff1f3);
                color: #4c6374;
                box-shadow: inset 0px 0px 10px 0px rgba(0,0,0,0.3);
                z-index: 1;
            }

        .tchmi-keyboard-template-label {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            display: none;
            overflow: hidden;
            pointer-events: none;
        }

            .tchmi-keyboard-template-label.top {
                align-items: flex-start;
            }

            .tchmi-keyboard-template-label.bottom {
                align-items: flex-end;
            }

            .tchmi-keyboard-template-label.left {
                justify-content: flex-start;
            }

            .tchmi-keyboard-template-label.right {
                justify-content: flex-end;
            }

            .tchmi-keyboard-template-label.show-always {
                display: flex;
            }

        .tchmi-keyboard.default-active .tchmi-keyboard-template-label.show-default {
            display: flex;
        }

        .tchmi-keyboard.shift-active:not(.capslock-active) .tchmi-keyboard-template-label.show-shift {
            display: flex;
        }

        .tchmi-keyboard.shift-active.capslock-active .tchmi-keyboard-template-key[data-no-caps-lock=true] .tchmi-keyboard-template-label.show-shift {
            display: flex;
        }

        .tchmi-keyboard.shift-active.capslock-active:not(.control-active):not(.alt-active):not(.altgr-active) .tchmi-keyboard-template-key:not([data-no-caps-lock=true]) .tchmi-keyboard-template-label.show-default {
            display: flex;
        }

        .tchmi-keyboard.control-active .tchmi-keyboard-template-label.show-control {
            display: flex;
        }

        .tchmi-keyboard.alt-active .tchmi-keyboard-template-label.show-alt {
            display: flex;
        }

        .tchmi-keyboard.altgr-active .tchmi-keyboard-template-label.show-altgr {
            display: flex;
        }

        .tchmi-keyboard.meta-active .tchmi-keyboard-template-label.show-meta {
            display: flex;
        }

        .tchmi-keyboard.capslock-active .tchmi-keyboard-template-label.show-capslock {
            display: flex;
        }

        .tchmi-keyboard.capslock-active:not(.shift-active) .tchmi-keyboard-template-key:not([data-no-caps-lock=true]) .tchmi-keyboard-template-label.show-shift {
            display: flex;
        }

        .tchmi-keyboard.numlock-active .tchmi-keyboard-template-label.show-numlock {
            display: flex;
        }

        .tchmi-keyboard.default-active .tchmi-keyboard-template-label.hide-default {
            display: none;
        }

        .tchmi-keyboard.shift-active:not(.capslock-active) .tchmi-keyboard-template-label.hide-shift {
            display: none;
        }

        .tchmi-keyboard.shift-active.capslock-active .tchmi-keyboard-template-key[data-no-caps-lock=true] .tchmi-keyboard-template-label.hide-shift {
            display: none;
        }

        .tchmi-keyboard.shift-active.capslock-active:not(.control-active):not(.alt-active):not(.altgr-active) .tchmi-keyboard-template-key:not([data-no-caps-lock=true]) .tchmi-keyboard-template-label.hide-default {
            display: none;
        }

        .tchmi-keyboard.control-active .tchmi-keyboard-template-label.hide-control {
            display: none;
        }

        .tchmi-keyboard.alt-active .tchmi-keyboard-template-label.hide-alt {
            display: none;
        }

        .tchmi-keyboard.altgr-active .tchmi-keyboard-template-label.hide-altgr {
            display: none;
        }

        .tchmi-keyboard.meta-active .tchmi-keyboard-template-label.hide-meta {
            display: none;
        }

        .tchmi-keyboard.capslock-active .tchmi-keyboard-template-label.hide-capslock {
            display: none;
        }

        .tchmi-keyboard.capslock-active:not(.shift-active) .tchmi-keyboard-template-key:not([data-no-caps-lock=true]) .tchmi-keyboard-template-label.hide-shift {
            display: none;
        }

        .tchmi-keyboard.numlock-active .tchmi-keyboard-template-label.hide-numlock {
            display: none;
        }

        .tchmi-keyboard .tchmi-keyboard-template-key.hover.down,
        .tchmi-keyboard .tchmi-keyboard-template-key.down .tchmi-keyboard-template-key.additional-key.hover,
        .tchmi-keyboard-template-key.show-additional-keys,
        .tchmi-keyboard-template-key.active {
            background: linear-gradient(135deg, #4162b0, #4994da);
            color: #ffffff;
            box-shadow: inset 0px 0px 5px 0px rgba(0,0,0,0.4);
        }

        .tchmi-keyboard-template-label svg {
            fill: none;
            stroke: currentColor;
            stroke-width: 1.1px;
        }
    </style>
    <!-- Styles for keyboard hidden -->
    <style id="hidden-keyboard-style">
        .keyboardcontainer.hidden {
            margin-bottom: 0px;
            height: 0;
        }
    </style>
    <!-- #endregion -->
    <!-- #region Script for keyboard
        ##################################
        Do not make any changes here
        -->
    <script>
        window.addEventListener('load', function () {

            var element = document.getElementById('TcHmiKeyboard');

            if (element) {
                var keyboard = new TcHmiKeyboard(element);
                keyboard.setScaleMode('ScaleToFitWidth');

                (function () {
                    var languages = window.locale ? [window.locale()] : navigator.languages ? navigator.languages : navigator.language ? [navigator.language] : navigator.userLanguage ? [navigator.userLanguage] : [];
                    languages = languages.map(function (lang) { return lang.toLowerCase(); });

                    var layouts = ['en-us_qwerty', 'de-de_qwertz'];

                    for (var i = 0, ii = languages.length; i < ii; i++) {
                        for (var j = 0, jj = layouts.length; j < jj; j++) {
                            if (layouts[j].indexOf(languages[i]) === 0) {
                                keyboard.setDefaultLayout(layouts[j]);
                                return;
                            }
                        }
                    }

                    languages = languages.map(function (lang) { return lang.split('-')[0]; });

                    for (var i = 0, ii = languages.length; i < ii; i++) {
                        for (var j = 0, jj = layouts.length; j < jj; j++) {
                            if (layouts[j].indexOf(languages[i]) === 0) {
                                keyboard.setDefaultLayout(layouts[j]);
                                return;
                            }
                        }
                    }

                    keyboard.setDefaultLayout(layouts[0]);
                })();

                var toggledown = false;
                document.getElementsByClassName('keyboard-toggle')[0].addEventListener('mousedown', function (event) {
                    toggledown = true;
                    event.preventDefault();
                });

                document.getElementsByClassName('keyboard-toggle')[0].addEventListener('mouseup', function (event) {
                    if (toggledown) {
                        toggledown = false;

                        var container = event.currentTarget.parentElement;
                        if (container.classList.contains('hidden')) {
                            container.classList.remove('hidden');
                        }
                        else {
                            container.classList.add('hidden');
                        }
                    }
                });

                var hiddenKeyboardStyle = document.getElementById('hidden-keyboard-style');
                var animationFrameId = null;
                function updateHiddenKeyboardStyle() {
                    var newStyle = '.keyboardcontainer.hidden {';
                    newStyle += 'margin-bottom: -' + keyboard.__element.getBoundingClientRect().height + 'px;';

                    var newStyleSansTransition = newStyle + 'transition: none;}'

                    newStyle += '}';

                    hiddenKeyboardStyle.innerHTML = newStyleSansTransition;

                    if (animationFrameId !== null) {
                        window.cancelAnimationFrame(animationFrameId);
                    }

                    animationFrameId = window.requestAnimationFrame(function () {
                        animationFrameId = window.requestAnimationFrame(function () {
                            hiddenKeyboardStyle.innerHTML = newStyle;

                            animationFrameId = null;
                        });
                    });
                }
                window.addEventListener('resize', updateHiddenKeyboardStyle);

                updateHiddenKeyboardStyle();
            }
        });

        /***** Keyboard code *****/
        function TcHmiKeyboard(element) {
            this.__currentLayout = { name: 'empty', dimensions: { width: 1, height: 1 } };
            this.__defaultLayout = '';
            this.__fixedTargetElements = null;
            /**
             * Internal reference to the attribute "data-tchmi-scale-mode"
             */
            this.__scaleMode = 'None';
            /**
             * Internal reference to the attribute "data-tchmi-fixed-target"
             */
            this.__fixedTarget = '';
            /**
             * Internal reference to the attribute "data-tchmi-release-sticky-keys-manually"
             */
            this.__releaseStickyKeysManually = false;
            /**
             * Internal reference to the attribute "data-tchmi-keyboard-padding"
             */
            this.__keyboardPadding = null;
            /**
             * Internal reference to the attribute "data-tchmi-key-padding"
             */
            this.__keyPadding = null;
            /**
             * Internal reference to the attribute "data-tchmi-additional-key-backdrop-padding"
             */
            this.__additionalKeyBackdropPadding = null;
            /**
             * Internal reference to the attribute "data-tchmi-longpress-delay"
             */
            this.__longpressDelay = 300;
            /**
             * Internal reference to the attribute "data-tchmi-repetition-delay"
             */
            this.__repetitionDelay = 50;
            /**
             * Internal reference to the attribute "data-tchmi-label-font-size"
             */
            this.__labelFontSize = 12;
            /**
             * Internal reference to the attribute "data-tchmi-label-font-size-unit"
             */
            this.__labelFontSizeUnit = 'px';
            /**
             * Internal reference to the attribute "data-tchmi-label-font-family"
             */
            this.__labelFontFamily = null;
            /**
             * Internal reference to the attribute "data-tchmi-label-font-style"
             */
            this.__labelFontStyle = 'Normal';
            /**
             * Internal reference to the attribute "data-tchmi-label-font-style"
             */
            this.__labelFontWeight = 'Normal';
            /**
             * Internal reference to the attribute "data-tchmi-label-stroke-thickness"
             */
            this.__labelStrokeThickness = null;
            /**
             * Internal reference to the attribute "data-tchmi-key-background-color"
             */
            this.__keyBackgroundColor = null;
            /**
             * Internal reference to the attribute "data-tchmi-label-color"
             */
            this.__labelColor = null;
            /**
             * Internal reference to the attribute "data-tchmi-label-stroke-color"
             */
            this.__labelStrokeColor = null;
            /**
             * Internal reference to the attribute "data-tchmi-label-fill-color"
             */
            this.__labelFillColor = null;
            /**
             * Internal reference to the attribute "data-tchmi-additional-key-backdrop-color"
             */
            this.__additionalKeyBackdropColor = null;
            /** Store modifier keys */
            this.__modifiers = {
                'Shift': false,
                'Control': false,
                'Alt': false,
                'Meta': false,
                'CapsLock': false,
                'NumLock': true,
                'Insert': false
            };
            /** Remember which keys are interacted with to reliably detect end of interaction */
            this.__pressedKeyMouse = null;
            this.__pressedKeysTouch = [];

            var _this = this;
            this.__keyActions = {
                'KeyChar': {
                    press: function (key, activeInput, sequenceIndex) {
                        if (activeInput === null) {
                            return;
                        }
                        var text = activeInput.value;
                        if (text === undefined || text === null) {
                            text = '';
                        }
                        var specialKey = _this.__specialKeys[key.key[sequenceIndex]];
                        var typedChar = specialKey !== undefined ? specialKey : key.key[sequenceIndex];
                        typedChar = _this.__unescape(typedChar);
                        if (_this.__compositionKey !== null && _this.__compositionKey.composition[typedChar] !== undefined) {
                            // use ! operator on this.__compositionKey.composition because __compositionKey is guaranteed to have that property or be null
                            // use ! operator on this.__compositionKey.composition![typedChar] because we already checked that for undefined, but TypeScript does not understand that
                            typedChar = _this.__compositionKey.composition[typedChar];
                        }
                        _this.__compositionKey = null;
                        var selectionStart = activeInput.selectionStart;
                        var selectionEnd = activeInput.selectionEnd;
                        activeInput.value = text.substring(0, selectionStart) + typedChar + text.substring(_this.__modifiers.Insert ? selectionEnd + 1 : selectionEnd);
                        _this.__setCaretPosition(activeInput, selectionStart + typedChar.length);
                    },
                    release: function (key, activeInput, sequenceIndex) {
                        if (!key.ignoreModifiers) {
                            if (!_this.__releaseStickyKeysManually) {
                                for (var i = 0, ii = _this.__stickiedKeys.length; i < ii; i++) {
                                    _this.__unstickKey(_this.__stickiedKeys[0]); // unstickKey removes keys from the array
                                }
                            }
                            _this.__keysToStick = [];
                        }
                    }
                },
                'Shift': { press: function (key, activeInput, sequenceIndex) { return _this.__toggleModifier('Shift', true); }, release: function (key, activeInput, sequenceIndex) { return _this.__toggleModifier('Shift', false); } },
                'Control': { press: function (key, activeInput, sequenceIndex) { return _this.__toggleModifier('Control', true); }, release: function (key, activeInput, sequenceIndex) { return _this.__toggleModifier('Control', false); } },
                'Alt': { press: function (key, activeInput, sequenceIndex) { return _this.__toggleModifier('Alt', true); }, release: function (key, activeInput, sequenceIndex) { return _this.__toggleModifier('Alt', false); } },
                'Meta': { press: function (key, activeInput, sequenceIndex) { return _this.__toggleModifier('Meta', true); }, release: function (key, activeInput, sequenceIndex) { return _this.__toggleModifier('Meta', false); } },
                'CapsLock': { press: function (key, activeInput, sequenceIndex) { return _this.__toggleModifier('CapsLock'); } },
                'NumLock': { press: function (key, activeInput, sequenceIndex) { return _this.__toggleModifier('NumLock'); } },
                'Insert': { press: function (key, activeInput, sequenceIndex) { return _this.__toggleModifier('Insert'); } },
                'ArrowLeft': {
                    press: function (key, activeInput, sequenceIndex) {
                        if (activeInput === null) {
                            return;
                        }
                        if (!(!_this.__modifiers.Shift && activeInput.selectionStart !== activeInput.selectionEnd)) {
                            _this.__moveCaret(activeInput, 'backward', function (currentPosition) { return _this.__caretPositionLeft(currentPosition, activeInput.value, key.ignoreModifiers); }, key.ignoreModifiers);
                        }
                        else {
                            _this.__setCaretPosition(activeInput, activeInput.selectionStart);
                        }
                        _this.__arrowUpDownTarget = null;
                    }
                },
                'ArrowRight': {
                    press: function (key, activeInput, sequenceIndex) {
                        if (activeInput === null) {
                            return;
                        }
                        if (!(!_this.__modifiers.Shift && activeInput.selectionStart !== activeInput.selectionEnd)) {
                            _this.__moveCaret(activeInput, 'forward', function (currentPosition) { return _this.__caretPositionRight(currentPosition, activeInput.value, key.ignoreModifiers); }, key.ignoreModifiers);
                        }
                        else {
                            _this.__setCaretPosition(activeInput, activeInput.selectionEnd);
                        }
                        _this.__arrowUpDownTarget = null;
                    }
                },
                'ArrowUp': {
                    press: function (key, activeInput, sequenceIndex) {
                        if (activeInput === null) {
                            return;
                        }
                        var caretPositionUp = function (currentPosition) {
                            var mirrorElement = _this.__getMirrorElement(activeInput);
                            var currentCoords = _this.__getCaretCoordinates(mirrorElement, activeInput.value, currentPosition);
                            var lastCoords = currentCoords;
                            var newPosition = currentPosition - 1;
                            var newCoords = _this.__getCaretCoordinates(mirrorElement, activeInput.value, newPosition);
                            if (_this.__arrowUpDownTarget === null || _this.__arrowUpDownTarget.input !== activeInput || _this.__arrowUpDownTarget.selectionStart !== activeInput.selectionStart || _this.__arrowUpDownTarget.selectionEnd !== activeInput.selectionEnd) {
                                _this.__arrowUpDownTarget = { left: currentCoords.left, input: activeInput, selectionStart: activeInput.selectionStart, selectionEnd: activeInput.selectionEnd };
                            }
                            while (newPosition >= 0 && (newCoords.top === currentCoords.top || newCoords.left > _this.__arrowUpDownTarget.left)) {
                                lastCoords = newCoords;
                                newPosition--;
                                newCoords = _this.__getCaretCoordinates(mirrorElement, activeInput.value, newPosition);
                            }
                            mirrorElement.parentNode.removeChild(mirrorElement);
                            if (newPosition < 0) {
                                return 0;
                            }
                            if (_this.__arrowUpDownTarget.left - newCoords.left <= lastCoords.left - _this.__arrowUpDownTarget.left || lastCoords.top === currentCoords.top) {
                                return newPosition;
                            }
                            return newPosition + 1;
                        };
                        _this.__moveCaret(activeInput, 'backward', caretPositionUp, key.ignoreModifiers);
                        if (_this.__arrowUpDownTarget !== null) {
                            _this.__arrowUpDownTarget.selectionStart = activeInput.selectionStart;
                            _this.__arrowUpDownTarget.selectionEnd = activeInput.selectionEnd;
                        }
                    }
                },
                'ArrowDown': {
                    press: function (key, activeInput, sequenceIndex) {
                        if (activeInput === null) {
                            return;
                        }
                        var caretPositionDown = function (currentPosition) {
                            var mirrorElement = _this.__getMirrorElement(activeInput);
                            var currentCoords = _this.__getCaretCoordinates(mirrorElement, activeInput.value, currentPosition);
                            var lastCoords = currentCoords;
                            var newPosition = currentPosition + 1;
                            var newCoords = _this.__getCaretCoordinates(mirrorElement, activeInput.value, newPosition);
                            var topDifference = 0;
                            if (_this.__arrowUpDownTarget === null || _this.__arrowUpDownTarget.input !== activeInput || _this.__arrowUpDownTarget.selectionStart !== activeInput.selectionStart || _this.__arrowUpDownTarget.selectionEnd !== activeInput.selectionEnd) {
                                _this.__arrowUpDownTarget = { left: currentCoords.left, input: activeInput, selectionStart: activeInput.selectionStart, selectionEnd: activeInput.selectionEnd };
                            }
                            while (newPosition <= activeInput.value.length && (newCoords.top === currentCoords.top || newCoords.left < _this.__arrowUpDownTarget.left) && (topDifference === 0 || newCoords.top - currentCoords.top <= topDifference)) {
                                topDifference = newCoords.top - currentCoords.top;
                                lastCoords = newCoords;
                                newPosition++;
                                newCoords = _this.__getCaretCoordinates(mirrorElement, activeInput.value, newPosition);
                            }
                            mirrorElement.parentNode.removeChild(mirrorElement);
                            if (newPosition > activeInput.value.length) {
                                return activeInput.value.length;
                            }
                            if (topDifference !== 0 && newCoords.top - currentCoords.top > topDifference) {
                                return newPosition - 1;
                            }
                            if (newCoords.left - _this.__arrowUpDownTarget.left < _this.__arrowUpDownTarget.left - lastCoords.left || lastCoords.top === currentCoords.top) {
                                return newPosition;
                            }
                            return newPosition - 1;
                        };
                        _this.__moveCaret(activeInput, 'forward', caretPositionDown, key.ignoreModifiers);
                        if (_this.__arrowUpDownTarget !== null) {
                            _this.__arrowUpDownTarget.selectionStart = activeInput.selectionStart;
                            _this.__arrowUpDownTarget.selectionEnd = activeInput.selectionEnd;
                        }
                    }
                },
                'Home': {
                    press: function (key, activeInput, sequenceIndex) {
                        if (activeInput === null) {
                            return;
                        }
                        var caretPositionHome = function (currentPosition) {
                            if (_this.__modifiers.Control && !key.ignoreModifiers) {
                                return 0;
                            }
                            var mirrorElement = _this.__getMirrorElement(activeInput);
                            var currentCoords = _this.__getCaretCoordinates(mirrorElement, activeInput.value, currentPosition);
                            var lastCoords = currentCoords;
                            var newPosition = currentPosition - 1;
                            var newCoords = _this.__getCaretCoordinates(mirrorElement, activeInput.value, newPosition);
                            while (newPosition >= 0 && newCoords.top === currentCoords.top) {
                                lastCoords = newCoords;
                                newPosition--;
                                newCoords = _this.__getCaretCoordinates(mirrorElement, activeInput.value, newPosition);
                            }
                            mirrorElement.parentNode.removeChild(mirrorElement);
                            if (newPosition < 0) {
                                return 0;
                            }
                            return newPosition + 1;
                        };
                        _this.__moveCaret(activeInput, 'backward', caretPositionHome, key.ignoreModifiers);
                    }
                },
                'End': {
                    press: function (key, activeInput, sequenceIndex) {
                        if (activeInput === null) {
                            return;
                        }
                        var caretPositionEnd = function (currentPosition) {
                            if (_this.__modifiers.Control && !key.ignoreModifiers) {
                                return activeInput.value.length;
                            }
                            var mirrorElement = _this.__getMirrorElement(activeInput);
                            var currentCoords = _this.__getCaretCoordinates(mirrorElement, activeInput.value, currentPosition);
                            var lastCoords = currentCoords;
                            var newPosition = currentPosition + 1;
                            var newCoords = _this.__getCaretCoordinates(mirrorElement, activeInput.value, newPosition);
                            while (newPosition <= activeInput.value.length && newCoords.top === currentCoords.top) {
                                lastCoords = newCoords;
                                newPosition++;
                                newCoords = _this.__getCaretCoordinates(mirrorElement, activeInput.value, newPosition);
                            }
                            mirrorElement.parentNode.removeChild(mirrorElement);
                            if (newPosition > activeInput.value.length) {
                                return activeInput.value.length;
                            }
                            return newPosition - 1;
                        };
                        _this.__moveCaret(activeInput, 'forward', caretPositionEnd, key.ignoreModifiers);
                    }
                },
                'Backspace': {
                    press: function (key, activeInput, sequenceIndex) {
                        if (activeInput === null) {
                            return;
                        }
                        var selectionStart = activeInput.selectionStart;
                        var selectionEnd = activeInput.selectionEnd;
                        var text = activeInput.value;
                        if (selectionStart === selectionEnd) {
                            selectionStart = _this.__caretPositionLeft(selectionStart, text, key.ignoreModifiers);
                        }
                        text = text.substring(0, selectionStart) + text.substring(selectionEnd);
                        activeInput.value = text;
                        _this.__setCaretPosition(activeInput, selectionStart);
                    }
                },
                'Delete': {
                    press: function (key, activeInput, sequenceIndex) {
                        if (activeInput === null) {
                            return;
                        }
                        var selectionStart = activeInput.selectionStart;
                        var selectionEnd = activeInput.selectionEnd;
                        var text = activeInput.value;
                        if (selectionStart === selectionEnd) {
                            selectionEnd = _this.__caretPositionRight(selectionEnd, text, key.ignoreModifiers);
                        }
                        text = text.substring(0, selectionStart) + text.substring(selectionEnd);
                        activeInput.value = text;
                        _this.__setCaretPosition(activeInput, selectionStart);
                    }
                },
                'SelectAll': {
                    press: function (key, activeInput, sequenceIndex) {
                        if (activeInput === null) {
                            return;
                        }
                        activeInput.selectionStart = 0;
                        activeInput.selectionEnd = activeInput.value.length;
                        activeInput.selectionDirection = 'forward';
                    },
                    release: function (key, activeInput, sequenceIndex) {
                        if (!key.ignoreModifiers) {
                            if (!_this.__releaseStickyKeysManually) {
                                for (var i = 0, ii = _this.__stickiedKeys.length; i < ii; i++) {
                                    _this.__unstickKey(_this.__stickiedKeys[0]); // unstickKey removes keys from the array
                                }
                            }
                            _this.__keysToStick = [];
                        }
                    }
                }
            };
            this.__keyCodes = {
                // Taken from https://w3c.github.io/uievents/#fixed-virtual-key-codes
                'Backspace': 8,
                'Tab': 9,
                'Enter': 13,
                'Shift': 16,
                'Control': 17,
                'Alt': 18,
                'CapsLock': 20,
                'Escape': 27,
                'Space': 32,
                'PageUp': 33,
                'PageDown': 34,
                'End': 35,
                'Home': 36,
                'ArrowLeft': 37,
                'ArrowUp': 38,
                'ArrowRight': 39,
                'ArrowDown': 40,
                'Delete': 46,
                // Taken from https://w3c.github.io/uievents/#optionally-fixed-virtual-key-codes
                // These are values that would be generated by a physical keyboard with US-layout.
                // In the real world these values would change depending on keyboard layout, but because KeyboardEvent.keyCode is deprecated and its use highly discouraged we just use US-layout values.
                ';': 186,
                ':': 186,
                '=': 187,
                '+': 187,
                ',': 188,
                '<': 188,
                '-': 189,
                '_': 189,
                '.': 190,
                '>': 190,
                '/': 191,
                '?': 191,
                //'`': 192,
                '~': 192,
                '[': 219,
                '{': 219,
                '\\': 220,
                '|': 220,
                ']': 221,
                '}': 221,
                '\'': 222,
                '"': 222,
                '^': 220,
                '´': 221,
                '`': 221
            };
            this.__specialKeys = {
                'Tab': '\t',
                'Enter': '\r\n'
            };
            this.__stickiedKeys = [];
            this.__keysToStick = [];
            this.__compositionKey = null;
            this.__interactedKeys = [];
            this.__additionalKeysBaseKey = null;
            this.__arrowUpDownTarget = null;

            this.__element = element;
            this.__elementTemplateRoot = this.__element.getElementsByClassName('tchmi-keyboard-template')[0];
            this.__elementPaddingContainer = this.__elementTemplateRoot.getElementsByClassName('tchmi-keyboard-template-padding-container')[0];

            window.addEventListener('resize', this.__onResized());
            this.__element.addEventListener('mousedown', this.__onRootMouseDownOrTouchStart());
            this.__element.addEventListener('touchstart', this.__onRootMouseDownOrTouchStart());
            Array.prototype.forEach.call(this.__elementPaddingContainer.getElementsByClassName('tchmi-keyboard-template-key'), function (element) {
                element.addEventListener('mousedown', _this.__onMouseDown());
                element.addEventListener('mouseenter', _this.__onMouseEnter());
                element.addEventListener('mouseleave', _this.__onMouseLeave());
                element.addEventListener('mouseup', _this.__onMouseUp());
                element.addEventListener('touchstart', _this.__onTouchStart());
                element.addEventListener('touchmove', _this.__onTouchMove());
                element.addEventListener('touchend', _this.__onTouchEndOrCancel());
                element.addEventListener('touchcancel', _this.__onTouchEndOrCancel());
            });

            for (var prop in this.__modifiers) if (this.__modifiers.hasOwnProperty(prop)) {
                if (this.__modifiers[prop]) {
                    this.__element.classList.add(prop.toLowerCase() + '-active');
                }
                else {
                    this.__element.classList.remove(prop.toLowerCase() + '-active');
                }
            }
            if (!this.__modifiers['Shift'] && !this.__modifiers['Control'] && !this.__modifiers['Alt'] && !this.__modifiers['CapsLock']) {
                this.__element.classList.add('default-active');
            }
            else {
                this.__element.classList.remove('default-active');
            }
            if (this.__modifiers['Control'] && this.__modifiers['Alt']) {
                this.__element.classList.add('altgr-active');
            }
            else {
                this.__element.classList.remove('altgr-active');
            }

            return this;
        }
        TcHmiKeyboard.prototype.__onResized = function () {
            var _this = this;
            return function (event) {
                _this.__processScaleMode();
            };
        };
        /**
         * Returns an event handler for the mousedown and touchstart events on the root element.
         * @function
         */
        TcHmiKeyboard.prototype.__onRootMouseDownOrTouchStart = function () {
            return function (event) {
                event.preventDefault(); // Prevent activeElement from losing focus.
            };
        };
        /**
         * Returns an event handler for the mousedown event.
         * @function
         */
        TcHmiKeyboard.prototype.__onMouseDown = function () {
            var _this = this;
            return function (event) {
                var keyElement = event.target;
                if (_this.__pressedKeyMouse === keyElement) {
                    return;
                }
                keyElement.classList.add('down');
                _this.__pressedKeyMouse = keyElement;
                _this.__keyInteractionStarted(keyElement);
            };
        };
        /**
         * Returns an event handler for the mouseenter event.
         * @funtion
         */
        TcHmiKeyboard.prototype.__onMouseEnter = function () {
            var _this = this;
            return function (event) {
                event.target.classList.add('hover');

                if (event.buttons > 0 && _this.__additionalKeysBaseKey !== null && _this.__additionalKeysBaseKey.dragging && _this.__additionalKeysBaseKey.element === event.target.parentElement) {
                    event.target.classList.add('down');
                }
            };
        };
        /**
         * Returns an event handler for the mouseleave event.
         * @function
         */
        TcHmiKeyboard.prototype.__onMouseLeave = function () {
            var _this = this;
            return function (event) {
                var keyElement = event.target;
                var interactedKey = _this.__handleMouseOrTouchLeave(keyElement, { x: event.clientX, y: event.clientY });
                if (interactedKey === null) {
                    return;
                }
                if (!(keyElement === _this.__pressedKeyMouse || keyElement.parentElement === _this.__pressedKeyMouse)) {
                    return;
                }
                _this.__pressedKeyMouse = null;
                _this.__interactedKeys = _this.__interactedKeys.filter(function (iKey) { return iKey.element !== interactedKey.element; });
                if (interactedKey.timeoutID !== -1) {
                    window.clearTimeout(interactedKey.timeoutID);
                }
            };
        };
        /**
         * Returns an event handler for the mouseup event.
         * @function
         */
        TcHmiKeyboard.prototype.__onMouseUp = function () {
            var _this = this;
            return function (event) {
                var keyElement = event.target;

                keyElement.classList.remove('down');

                if (_this.__additionalKeysBaseKey !== null) {
                    if (_this.__additionalKeysBaseKey.dragging && _this.__additionalKeysBaseKey.element === keyElement.parentElement) {
                        _this.__pressedKeyMouse = keyElement;
                        _this.__keyInteractionStarted(keyElement);
                    }
                    _this.__additionalKeysBaseKey.dragging = false;
                }

                if (keyElement !== _this.__pressedKeyMouse) {
                    return;
                }

                _this.__pressedKeyMouse = null;
                _this.__keyInteractionEnded(keyElement);
            };
        };
        /**
         * Returns an event handler for the touchstart event.
         * @function
         */
        TcHmiKeyboard.prototype.__onTouchStart = function () {
            var _this = this;
            return function (event) {
                var touch = null;
                for (var i = 0, ii = event.changedTouches.length; i < ii; i++) {
                    if (event.changedTouches[i].target === event.target) {
                        touch = event.changedTouches[i];
                        break;
                    }
                }
                if (touch === null) {
                    return;
                }
                var keyElement = event.target;
                if (_this.__pressedKeysTouch.filter(function (pressedKey) { return pressedKey.keyElement === keyElement; }).length > 0) {
                    return;
                }
                keyElement.classList.add('hover');
                keyElement.classList.add('down');
                _this.__pressedKeysTouch.push({ touchID: touch.identifier, keyElement: keyElement });
                _this.__keyInteractionStarted(keyElement);
            };
        };
        /**
         * Returns an event handler for the touchmove event.
         * @function
         */
        TcHmiKeyboard.prototype.__onTouchMove = function () {
            var _this = this;
            return function (event) {
                var touch = null;
                var pressedKey;

                for (var i = 0, ii = event.changedTouches.length; i < ii; i++) {
                    if (event.changedTouches[i].target === event.target) {
                        pressedKey = _this.__pressedKeysTouch.filter(function (pressedKey) { return pressedKey.touchID === event.changedTouches[i].identifier; })[0];
                        if (pressedKey !== undefined) {
                            touch = event.changedTouches[i];
                            break;
                        }
                    }
                }

                if (touch === null || pressedKey === undefined) {
                    return;
                }
                var keyElement = document.elementFromPoint(touch.clientX, touch.clientY);
                if (keyElement !== null && keyElement.classList.contains('tchmi-keyboard-template-label')) {
                    keyElement = keyElement.parentElement;
                }
                if (keyElement !== null && !keyElement.classList.contains('tchmi-keyboard-template-key')) {
                    keyElement = null;
                }
                if (keyElement !== pressedKey.keyElement && pressedKey.keyElement !== null) {
                    var interactedKey = _this.__handleMouseOrTouchLeave(pressedKey.keyElement, { x: touch.clientX, y: touch.clientY });
                    pressedKey.keyElement = null;
                    if (interactedKey === null) {
                        return;
                    }
                }

                if (keyElement !== null && pressedKey.keyElement === null) { // enter
                    keyElement.classList.add('hover');
                    if (_this.__additionalKeysBaseKey !== null && _this.__additionalKeysBaseKey.dragging && _this.__additionalKeysBaseKey.element === keyElement.parentElement) {
                        keyElement.classList.add('down');
                    }
                    pressedKey.keyElement = keyElement;
                }
            };
        };
        /**
         * Returns an event handler for the touchend and touchmove events.
         * @function
         */
        TcHmiKeyboard.prototype.__onTouchEndOrCancel = function () {
            var _this = this;
            return function (event) {
                var touch = null;

                for (var i = 0, ii = event.changedTouches.length; i < ii; i++) {
                    if (event.changedTouches[i].target === event.target) {
                        if (_this.__pressedKeysTouch.filter(function (pressedKey) { return pressedKey.touchID === event.changedTouches[i].identifier; }).length > 0) {
                            touch = event.changedTouches[i];
                            break;
                        }
                    }
                }

                if (touch === null) {
                    return;
                }
                event.target.classList.remove('hover');
                event.target.classList.remove('down');
                for (var i = 0, ii = _this.__pressedKeysTouch.length; i < ii; i++) {
                    if (_this.__pressedKeysTouch[i].touchID === touch.identifier) {
                        _this.__pressedKeysTouch.splice(i, 1);
                        break;
                    }
                }
                var keyElement = document.elementFromPoint(touch.clientX, touch.clientY);
                if (keyElement !== null && keyElement.classList.contains('tchmi-keyboard-template-label')) {
                    keyElement = keyElement.parentElement;
                }
                if (keyElement !== null) {
                    keyElement.classList.remove('hover');
                    keyElement.classList.remove('down');
                }
                if (keyElement !== null && !keyElement.classList.contains('tchmi-keyboard-template-key')) {
                    keyElement = null;
                }
                if (keyElement === null || (keyElement !== event.target && keyElement.parentElement !== event.target)) {
                    return;
                }
                if (keyElement.classList.contains('additional-key') && keyElement.parentElement === event.target) {
                    _this.__keyInteractionStarted(keyElement);
                }

                if (_this.__additionalKeysBaseKey !== null) {
                    if (_this.__additionalKeysBaseKey.dragging && _this.__additionalKeysBaseKey.element === keyElement.parentElement) {
                        _this.__keyInteractionStarted(keyElement);
                    }
                    _this.__additionalKeysBaseKey.dragging = false;
                }

                _this.__keyInteractionEnded(keyElement);
            };
        };
        /**
         * Handles the case when the mouse cursor or a touchpoint leaves the currently interacted with key.
         * @param keyElement    The key HTML element that is being interacted with.
         * @param coordinates   The coordinates of the mouse cursor or touch point.
         * @function
         */
        TcHmiKeyboard.prototype.__handleMouseOrTouchLeave = function (keyElement, coordinates) {
            keyElement.classList.remove('hover');
            keyElement.classList.remove('down');
            var interactedKey = this.__interactedKeys.filter(function (iKey) { return iKey.element === keyElement; })[0];
            if (interactedKey === undefined) {
                return null;
            }
            if (interactedKey.key.longpressAction === TcHmiKeyboard.LongpressAction.ADDITIONALKEYS && !interactedKey.timedOut) {
                var boundingRectKey = keyElement.getBoundingClientRect();
                var keyCenter = { x: boundingRectKey.left + boundingRectKey.width / 2, y: boundingRectKey.top + boundingRectKey.height / 2 };
                var additionalKeyBoundingRect = keyElement.getElementsByClassName('tchmi-keyboard-template-backdrop')[0].getBoundingClientRect();
                var direction = { x: Math.round((coordinates.x - keyCenter.x) / boundingRectKey.width), y: Math.round((coordinates.y - keyCenter.y) / boundingRectKey.height) };
                var showAdditionalKeys = false;
                if (additionalKeyBoundingRect.top < keyCenter.y && additionalKeyBoundingRect.left < keyCenter.x && additionalKeyBoundingRect.right > keyCenter.x && direction.y <= -1) {
                    showAdditionalKeys = true;
                }
                else if (additionalKeyBoundingRect.bottom > keyCenter.y && additionalKeyBoundingRect.left < keyCenter.x && additionalKeyBoundingRect.right > keyCenter.x && direction.y >= 1) {
                    showAdditionalKeys = true;
                }
                else if (additionalKeyBoundingRect.left < keyCenter.x && additionalKeyBoundingRect.top < keyCenter.y && additionalKeyBoundingRect.bottom > keyCenter.y && direction.x <= -1) {
                    showAdditionalKeys = true;
                }
                else if (additionalKeyBoundingRect.right > keyCenter.x && additionalKeyBoundingRect.top < keyCenter.y && additionalKeyBoundingRect.bottom > keyCenter.y && direction.x >= 1) {
                    showAdditionalKeys = true;
                }

                if (showAdditionalKeys) {
                    if (interactedKey.timeoutID !== -1) {
                        window.clearTimeout(interactedKey.timeoutID);
                        interactedKey.timeoutID = -1;
                    }
                    interactedKey.timedOut = true;

                    this.__showAdditionalKeys(interactedKey.element);

                    return null;
                }
            }

            this.__interactedKeys = this.__interactedKeys.filter(function (iKey) { return iKey.element !== interactedKey.element; });
            if (interactedKey.timeoutID !== -1) {
                window.clearTimeout(interactedKey.timeoutID);
                interactedKey.timeoutID = -1;
            }

            return interactedKey;
        };

        /**
         * Show additional keys.
         * @param keyElement The key HTML element containing the additional keys.
         * @function
         */
        TcHmiKeyboard.prototype.__showAdditionalKeys = function (keyElement) {
            keyElement.classList.add('show-additional-keys');
            this.__additionalKeysBaseKey = { element: keyElement, dragging: true };
        };

        /**
         * Hide additional keys and remove the key containing the additional keys from interactedKeys.
         * @function
         */
        TcHmiKeyboard.prototype.__hideAdditionalKeys = function () {
            var _this = this;
            if (this.__additionalKeysBaseKey !== null) {
                this.__additionalKeysBaseKey.element.classList.remove('show-additional-keys');
                this.__interactedKeys = this.__interactedKeys.filter(function (iKey) { return iKey.element !== _this.__additionalKeysBaseKey.element; });
                this.__additionalKeysBaseKey = null;
            }
        };
        /**
         * Handles beginning of interaction with keys. Registers the key as being interacted with and sets timeout functions if longpress action is not none.
         * @param keyElement The key HTML element on which the interaction has started.
         * @function
         */
        TcHmiKeyboard.prototype.__keyInteractionStarted = function (keyElement) {
            var _this = this;
            if (this.__additionalKeysBaseKey !== null && this.__additionalKeysBaseKey.element !== keyElement && this.__additionalKeysBaseKey.element !== keyElement.parentElement) {
                this.__hideAdditionalKeys();
            }

            var interactedKey = this.__interactedKeys.filter(function (iKey) { return iKey.element === keyElement; })[0];
            if (interactedKey !== undefined) {
                interactedKey.hideAdditionalKeys = true;
                return;
            }
            interactedKey = { element: keyElement, key: this.__getKey(keyElement), timeoutID: -1, timedOut: false };

            if (this.__additionalKeysBaseKey !== null && this.__additionalKeysBaseKey.element === interactedKey.element) {
                interactedKey.hideAdditionalKeys = true;
            }
            else if (!TcHmiKeyboard.isLayoutSwitch(interactedKey.key)) {
                switch (interactedKey.key.longpressAction) {
                    case TcHmiKeyboard.LongpressAction.REPEAT:
                        interactedKey.timeoutID = window.setTimeout(function () {
                            var repeat = function () {
                                _this.__pressKey(interactedKey.key);
                                interactedKey.timeoutID = window.setTimeout(repeat, _this.__repetitionDelay);
                            };
                            _this.__pressKey(interactedKey.key);
                            interactedKey.timedOut = true;
                            interactedKey.timeoutID = window.setTimeout(repeat, _this.__repetitionDelay);
                        }, this.__longpressDelay);
                        break;
                    case TcHmiKeyboard.LongpressAction.ADDITIONALKEYS:
                        interactedKey.timeoutID = window.setTimeout(function () {
                            _this.__showAdditionalKeys(interactedKey.element);
                            interactedKey.timedOut = true;
                            interactedKey.timeoutID = -1;
                        }, this.__longpressDelay);
                        break;
                    case TcHmiKeyboard.LongpressAction.NONE:
                        if (interactedKey.key.type === TcHmiKeyboard.KeyType.MODIFIER) {
                            this.__pressKey(interactedKey.key);
                            if (this.__keysToStick.filter(function (k) { return k.key.join(',') === interactedKey.key.key.join(',') && k.keyPath.join('-') === interactedKey.key.keyPath.join('-'); }).length === 0) {
                                this.__keysToStick.push(interactedKey.key);
                            }
                        }
                        break;
                }
            }
            this.__interactedKeys.push(interactedKey);
        };
        /**
         * Handles end of interaction with keys. Registers the key as a stickied key when it is marked as sticky, otherwise releases it.
         * @param keyElement The key HTML element on which the interaction has ended.
         * @function
         */
        TcHmiKeyboard.prototype.__keyInteractionEnded = function (keyElement) {
            var interactedKey = this.__interactedKeys.filter(function (iKey) { return iKey.element === keyElement; })[0];
            if (interactedKey === undefined) {
                return;
            }
            if (this.__additionalKeysBaseKey !== null && this.__additionalKeysBaseKey.element === interactedKey.element) {
                if (interactedKey.hideAdditionalKeys) {
                    this.__hideAdditionalKeys();
                }
                return;
            }
            if (interactedKey.element.classList.contains('additional-key')) {
                this.__hideAdditionalKeys();
            }
            var key = interactedKey.key;
            this.__interactedKeys.splice(this.__interactedKeys.indexOf(interactedKey), 1);
            if (!(interactedKey.timedOut || (!TcHmiKeyboard.isLayoutSwitch(interactedKey.key) && interactedKey.key.longpressAction === TcHmiKeyboard.LongpressAction.NONE && interactedKey.key.type === TcHmiKeyboard.KeyType.MODIFIER))) {
                this.__pressKey(key);
            }
            if (interactedKey.timeoutID !== -1) {
                window.clearTimeout(interactedKey.timeoutID);
                interactedKey.timeoutID = -1;
            }
            if (TcHmiKeyboard.isLayoutSwitch(key)) {
                this.__releaseKey(key);
            }
            else {
                if (key.mode === TcHmiKeyboard.KeyMode.STICKY) {
                    if (!key.active) {
                        var keyToStick = this.__keysToStick.filter(function (k) { return k.key.join(',') === key.key.join(',') && k.keyPath.join('-') === key.keyPath.join('-'); })[0];
                        if (keyToStick !== undefined) {
                            this.__stickKey(key);
                            this.__keysToStick.splice(this.__keysToStick.indexOf(keyToStick), 1);
                        }
                        else {
                            this.__releaseKey(key);
                        }
                    }
                    else {
                        this.__unstickKey(key);
                    }
                }
                else {
                    this.__releaseKey(key);
                    if (key.mode === TcHmiKeyboard.KeyMode.TOGGLE) {
                        Array.prototype.forEach.call(this.__element.querySelectorAll("div.tchmi-keyboard-template-key[data-" + key.keyPath.join('-') + "=\"" + key.key.join(',') + "\"]"), function (element) { element.classList.toggle('active'); });
                    }
                }
            }
        };
        /**
         * Dispatch events for the pressed key and call the associated action.
         * @param key The key to press.
         * @function
         */
        TcHmiKeyboard.prototype.__pressKey = function (key) {
            if (!TcHmiKeyboard.isLayoutSwitch(key)) {
                if (!(key.active && key.mode === TcHmiKeyboard.KeyMode.STICKY)) {
                    var targetElements = this.__getTargetElements();
                    for (var i = 0, ii = targetElements.length; i < ii; i++) {
                        for (var j = 0, jj = key.code.length; j < jj; j++) {
                            var cancelled = !this.__dispatchEvent(targetElements[i], 'keydown', key, j);
                            var compositionKeyFirstPress = false;
                            if (key.composition !== undefined) {
                                compositionKeyFirstPress = this.__compositionKey === null;
                                if (compositionKeyFirstPress) {
                                    this.__compositionKey = key;
                                }
                            }
                            if (this.__compositionKey !== null && key.type === TcHmiKeyboard.KeyType.CHARACTER && !compositionKeyFirstPress) {
                                if (this.__compositionKey.composition[key.key[j]] === undefined) {
                                    if (this.__dispatchEvent(targetElements[i], 'keypress', this.__compositionKey, 0)) {
                                        var action = this.__keyActions['KeyChar'];
                                        if (action !== undefined) {
                                            if (targetElements[i] instanceof HTMLInputElement || targetElements[i] instanceof HTMLTextAreaElement) {
                                                action.press(this.__compositionKey, targetElements[i], 0);
                                            }
                                            else {
                                                action.press(this.__compositionKey, null, 0);
                                            }
                                        }
                                    }
                                }
                            }
                            if (key.valid && !cancelled && !compositionKeyFirstPress) {
                                if (key.type === TcHmiKeyboard.KeyType.CHARACTER) {
                                    cancelled = !this.__dispatchEvent(targetElements[i], 'keypress', key, j);
                                }
                                var action = this.__keyActions[key.type === TcHmiKeyboard.KeyType.CHARACTER ? 'KeyChar' : key.key[j] || ''];
                                if (action !== undefined && !cancelled) {
                                    if (targetElements[i] instanceof HTMLInputElement || targetElements[i] instanceof HTMLTextAreaElement) {
                                        action.press(key, targetElements[i], j);
                                    }
                                    else {
                                        action.press(key, null, j);
                                    }
                                }
                            }
                        }
                    }
                }
            }
        };
        /**
         * Dispatch events for the released key and call the associated action.
         * @param key The key to release.
         * @function
         */
        TcHmiKeyboard.prototype.__releaseKey = function (key) {
            if (TcHmiKeyboard.isLayoutSwitch(key)) {
                this.__activateLayout(key.layoutName);
            }
            else {
                var targetElements = this.__getTargetElements();
                for (var i = 0, ii = targetElements.length; i < ii; i++) {
                    for (var j = 0, jj = key.code.length; j < jj; j++) {
                        var cancelled = !this.__dispatchEvent(targetElements[i], 'keyup', key, j);
                        if (key.valid && !cancelled) {
                            var action = this.__keyActions[key.type === TcHmiKeyboard.KeyType.CHARACTER ? 'KeyChar' : key.key[j] || ''];
                            if (action !== undefined && action.release !== undefined) {
                                if (targetElements[i] instanceof HTMLInputElement || targetElements[i] instanceof HTMLTextAreaElement) {
                                    action.release(key, targetElements[i], j);
                                }
                                else {
                                    action.release(key, null, j);
                                }
                            }
                        }
                    }
                }
            }
        };
        /**
         * Get a key object from the HTMLElement which was interacted with.
         * @param keyElement The HTMLElement representing the key.
         * @function
         */
        TcHmiKeyboard.prototype.__getKey = function (keyElement) {
            var _this = this;
            function splitWithConsecutiveTokens(value, token) {
                if (value === undefined) {
                    return [];
                }
                var lastIndex = 0;
                var tokenIndex = value.indexOf(token, lastIndex + 1);
                var res = [];
                while (tokenIndex > -1) {
                    res.push(value.substring(lastIndex, tokenIndex));
                    lastIndex = tokenIndex + token.length;
                    tokenIndex = value.indexOf(token, lastIndex + 1);
                }
                if (lastIndex < value.length) {
                    res.push(value.substring(lastIndex));
                }
                return res;
            }
            if (keyElement.dataset['type'] === 'layout-switch') {
                return { type: TcHmiKeyboard.KeyType.LAYOUTSWITCH, layoutName: keyElement.dataset['layoutName'] };
            }
            var key = {
                code: splitWithConsecutiveTokens(keyElement.dataset['code'], ','),
                key: [],
                keyPath: [],
                unmodifiedKey: splitWithConsecutiveTokens(keyElement.dataset['key'], ','),
                type: TcHmiKeyboard.KeyType[(keyElement.dataset['type'] || '').toUpperCase()] || TcHmiKeyboard.KeyType.CHARACTER,
                mode: TcHmiKeyboard.KeyMode[(keyElement.dataset['mode'] || '').toUpperCase()] || TcHmiKeyboard.KeyMode.NORMAL,
                location: (keyElement.dataset['location'] || '').split(',').map(function (value) { return TcHmiKeyboard.KeyLocation[value.toUpperCase()] || TcHmiKeyboard.KeyLocation.STANDARD; }),
                active: keyElement.classList.contains('active'),
                noCapsLock: (keyElement.dataset['noCapsLock'] || '').toUpperCase() === 'TRUE',
                ignoreModifiers: (keyElement.dataset['ignoreModifiers'] || '').toUpperCase() === 'TRUE',
                valid: true,
                longpressAction: TcHmiKeyboard.LongpressAction[(keyElement.dataset['longpressAction'] || '').toUpperCase()] || TcHmiKeyboard.LongpressAction.NONE
            };
            var getPath = function () {
                var keyPath = [];
                if (_this.__modifiers.Shift) {
                    keyPath.push('shift');
                }
                if (_this.__modifiers.Control) {
                    keyPath.push('ctrl');
                }
                if (_this.__modifiers.Alt) {
                    keyPath.push('alt');
                }
                if (_this.__modifiers.CapsLock && !key.noCapsLock) {
                    if (keyPath.indexOf('shift') === -1) {
                        if (keyPath.indexOf('ctrl') === -1 && keyPath.indexOf('alt') === -1) {
                            keyPath.unshift('shift');
                        }
                    }
                    else {
                        keyPath.shift(); // if 'shift' is in keyPath it must be the first item.
                    }
                }
                if (_this.__modifiers.NumLock && Object.keys(keyElement.dataset).filter(function (key) { return key.indexOf('numlock') === 0; }).length > 0) {
                    keyPath.unshift('numlock');
                }
                return keyPath;
            };
            function capitalise(value) {
                return value.substr(0, 1).toUpperCase() + value.substr(1);
            }
            var path = [];
            if (!key.ignoreModifiers) {
                path = getPath();
            }
            var pathedType = keyElement.dataset[path.concat(['type']).reduce(function (accumulator, currentValue) { return accumulator + capitalise(currentValue); })];
            if (pathedType !== undefined && path.length > 0) {
                key.type = TcHmiKeyboard.KeyType[pathedType];
            }
            else if (key.type !== TcHmiKeyboard.KeyType.CHARACTER) {
                path = [];
            }
            var keyData = keyElement.dataset[path.concat(['key']).reduce(function (accumulator, currentValue) { return accumulator + capitalise(currentValue); })];
            var compositionPath = path.concat(['composition']).reduce(function (accumulator, currentValue) { return accumulator + capitalise(currentValue); });
            if (keyElement.dataset[compositionPath] !== undefined) {
                key.composition = keyElement.dataset[compositionPath] === undefined ? undefined : JSON.parse(keyElement.dataset[compositionPath]);
            }
            if (keyData === undefined) {
                key.valid = false;
                keyData = keyElement.dataset['key'];
            }
            key.key = splitWithConsecutiveTokens(keyData, ',');
            if (key.key[0] === 'Any') {
                if (this.__getKey.__anyKey === undefined) {
                    key.unmodifiedKey[0] = key.key[0] = String.fromCharCode(Math.floor(Math.random() * 95 + 32));
                    this.__getKey.__anyKey = key.key[0];
                }
                else {
                    key.unmodifiedKey[0] = key.key[0] = this.__getKey.__anyKey;
                    delete this.__getKey.__anyKey;
                }
            }
            key.keyPath = path.concat(['key']);
            if (key.code.length > key.key.length) {
                key.code.splice(key.key.length, key.code.length - key.key.length);
            }
            else if (key.key.length > key.code.length) {
                key.key.splice(key.code.length, key.key.length - key.code.length);
            }
            if (key.location.length < key.code.length) {
                for (var i = key.location.length, ii = key.code.length; i < ii; i++) {
                    key.location.push(TcHmiKeyboard.KeyLocation.STANDARD);
                }
            }
            else if (key.location.length > key.code.length) {
                key.location.splice(key.code.length, key.location.length - key.code.length);
            }
            return key;
        };
        /**
         * Gets the input and textarea elements that KeyboardEvents should be sent to and characters typed into.
         * @function
         */
        TcHmiKeyboard.prototype.__getTargetElements = function () {
            if (this.__fixedTarget !== '') {
                return this.__fixedTargetElements;
            }
            else {
                return [document.activeElement];
            }
        };
        /**
         * Dispatch a keydown, keypress or keyup event.
         * @param target        The element which will receive the event.
         * @param type          The type of the event; keydown, keypress or keyup.
         * @param key           The key which was pressed or released.
         * @param sequenceIndex The index of the key and code in the key object. Useful when more than one key is mapped to a "physical" key.
         * @returns Whether the event propagated all the way to the root element or whether preventDefault was called.
         * @function
         */
        TcHmiKeyboard.prototype.__dispatchEvent = function (target, type, key, sequenceIndex) {
            var eventInit = {
                key: key.composition !== undefined && type !== 'keypress' ? 'Dead' : key.key[sequenceIndex],
                code: key.code[sequenceIndex],
                location: key.location[sequenceIndex],
                shiftKey: this.__modifiers.Shift,
                ctrlKey: this.__modifiers.Control,
                altKey: this.__modifiers.Alt,
                metaKey: this.__modifiers.Meta,
                bubbles: true,
                cancelable: true
            };
            if (this.__compositionKey !== null && this.__compositionKey.composition[eventInit.key] !== undefined) {
                eventInit.key = this.__compositionKey.composition[eventInit.key];
            }
            if (type === 'keypress' && key.type === TcHmiKeyboard.KeyType.CHARACTER) {
                if (key.key[sequenceIndex] !== undefined) {
                    var specialKey = this.__specialKeys[key.key[sequenceIndex]];
                    var typedChar = specialKey !== undefined ? specialKey : key.key[sequenceIndex];
                    typedChar = this.__unescape(typedChar);
                    if (this.__compositionKey !== null && this.__compositionKey.composition[typedChar] !== undefined) {
                        // use ! operator on this.__compositionKey.composition because __compositionKey is guaranteed to have that property or be null
                        // use ! operator on this.__compositionKey.composition![typedChar] because we already checked that for undefined, but TypeScript does not understand that
                        typedChar = this.__compositionKey.composition[typedChar];
                    }
                    eventInit.charCode = typedChar.charCodeAt(0);
                    eventInit.keyCode = eventInit.charCode;
                    eventInit.which = eventInit.charCode;
                }
            }
            else {
                if (this.__keyCodes[key.key[sequenceIndex]] !== undefined) {
                    eventInit.keyCode = this.__keyCodes[key.key[sequenceIndex]];
                    eventInit.which = eventInit.keyCode;
                }
                else if (key.type === TcHmiKeyboard.KeyType.CHARACTER) {
                    if (key.unmodifiedKey[sequenceIndex] !== undefined) {
                        eventInit.keyCode = this.__unescape(key.unmodifiedKey[sequenceIndex]).toUpperCase().charCodeAt(0);
                    }
                    else if (key.key[sequenceIndex] !== undefined) {
                        eventInit.keyCode = this.__unescape(key.key[sequenceIndex]).toUpperCase().charCodeAt(0);
                    }
                    eventInit.which = eventInit.keyCode;
                }
            }
            var event;
            if (typeof KeyboardEvent === 'function') {
                event = new KeyboardEvent(type, eventInit);
            }
            else {
                var modifiers = [];
                if (eventInit.altKey) {
                    modifiers.push('Alt');
                }
                if (eventInit.altKey && eventInit.ctrlKey) {
                    modifiers.push('AltGraph');
                }
                if (this.__modifiers.CapsLock) {
                    modifiers.push('CapsLock');
                }
                if (eventInit.ctrlKey) {
                    modifiers.push('Control');
                }
                if (eventInit.metaKey) {
                    modifiers.push('Meta');
                }
                if (this.__modifiers.NumLock) {
                    modifiers.push('NumLock');
                }
                if (eventInit.shiftKey) {
                    modifiers.push('Shift');
                }
                event = document.createEvent('KeyboardEvent');
                event.initKeyboardEvent(type, eventInit.bubbles || false, eventInit.cancelable || false, window, eventInit.key || '', eventInit.location || 0, modifiers.join(' '), eventInit.repeat || false, '');
            }
            if (event.which !== eventInit.which && eventInit.which !== undefined) {
                // Override 'which' property to return value of 'whichVal', that we then add to the Object.
                Object.defineProperty(event, 'which', {
                    get: function () {
                        return this.whichVal;
                    }
                });
                event.whichVal = eventInit.which;
                if (eventInit.charCode !== undefined) {
                    Object.defineProperty(event, 'charCode', {
                        get: function () {
                            return this.charCodeVal;
                        }
                    });
                    event.charCodeVal = eventInit.charCode;
                }
                if (eventInit.keyCode !== undefined) {
                    Object.defineProperty(event, 'keyCode', {
                        get: function () {
                            return this.keyCodeVal;
                        }
                    });
                    event.keyCodeVal = eventInit.keyCode;
                }
            }
            return target.dispatchEvent(event);
        };
        /**
         * Changes the value of the specified modifier and sets the corresponding classes on the control root element.
         * @param key   The modifier to change.
         * @param value The new value of the modifier. If this parameter is not specified, the modifier is inverted.
         * @function
         */
        TcHmiKeyboard.prototype.__toggleModifier = function (key, value) {
            if (value === undefined) {
                this.__modifiers[key] = !this.__modifiers[key];
            }
            else {
                this.__modifiers[key] = value;
            }

            if (this.__modifiers[key]) {
                this.__element.classList.add(key.toLowerCase() + '-active');
            }
            else {
                this.__element.classList.remove(key.toLowerCase() + '-active');
            }
            if (!this.__modifiers['Shift'] && !this.__modifiers['Control'] && !this.__modifiers['Alt'] && !this.__modifiers['CapsLock']) {
                this.__element.classList.add('default-active');
            }
            else {
                this.__element.classList.remove('default-active');
            }
            if (this.__modifiers['Control'] && this.__modifiers['Alt']) {
                this.__element.classList.add('altgr-active');
            }
            else {
                this.__element.classList.remove('altgr-active');
            }
        };
        /**
         * Registers a key as stickied.
         * @param key The key to stick.
         * @function
         */
        TcHmiKeyboard.prototype.__stickKey = function (key) {
            if (key.mode !== TcHmiKeyboard.KeyMode.STICKY) {
                return;
            }
            this.__stickiedKeys.push(key);
            Array.prototype.forEach.call(this.__element.querySelectorAll("div.tchmi-keyboard-template-key[data-" + key.keyPath.join('-') + "=\"" + key.key.join(',') + "\"]"), function (element) { element.classList.add('active'); });
        };
        /**
         * Unregisters a stickied key and releases it.
         * @param key The key to unstick.
         * @function
         */
        TcHmiKeyboard.prototype.__unstickKey = function (key) {
            if (key.mode !== TcHmiKeyboard.KeyMode.STICKY) {
                return;
            }
            var keyIndex = this.__stickiedKeys.indexOf(key);
            if (keyIndex === -1) {
                for (var i = 0, ii = this.__stickiedKeys.length; i < ii; i++) {
                    if (this.__stickiedKeys[i].key.join(',') === key.key.join(',') && this.__stickiedKeys[i].keyPath.join('-') === key.keyPath.join('-')) {
                        keyIndex = i;
                        break;
                    }
                }
            }
            if (keyIndex !== -1) {
                this.__releaseKey(this.__stickiedKeys[keyIndex]);
                this.__stickiedKeys.splice(keyIndex, 1);
            }
            Array.prototype.forEach.call(this.__element.querySelectorAll("div.tchmi-keyboard-template-key[data-" + key.keyPath.join('-') + "=\"" + key.key.join(',') + "\"]"), function (element) { element.classList.remove('active'); });
        };
        /**
         * Gets the new caret position when an action is performed that moves the caret left. Respects the state of the control key.
         * @param currentPosition   The current position of the caret.
         * @param text              The text the caret is positioned in.
         * @function
         */
        TcHmiKeyboard.prototype.__caretPositionLeft = function (currentPosition, text, ignoreModifiers) {
            if (this.__modifiers.Control && !ignoreModifiers) {
                var boundariesRegEx = /\b\S/g; // word boundary followed by non-whitespace char
                var match = boundariesRegEx.exec(text);
                var previousIndex = 0;
                while (match) {
                    if (match.index >= currentPosition) {
                        break;
                    }
                    previousIndex = match.index;
                    match = boundariesRegEx.exec(text);
                }
                return previousIndex;
            }
            else {
                return currentPosition > 0 ? currentPosition - 1 : 0;
            }
        };
        /**
         * Gets the new caret position when an action is performed that moves the caret right. Respects the state of the control key.
         * @param currentPosition   The current position of the caret.
         * @param text              The text the caret is positioned in.
         * @function
         */
        TcHmiKeyboard.prototype.__caretPositionRight = function (currentPosition, text, ignoreModifiers) {
            if (this.__modifiers.Control && !ignoreModifiers) {
                var boundariesRegEx = /\S\s*\b/g; // non-whitespace char followed by optional whitespace chars followed by word boundary
                var match = boundariesRegEx.exec(text);
                while (match) {
                    if (match.index + 1 > currentPosition) {
                        break;
                    }
                    match = boundariesRegEx.exec(text);
                }
                return match !== null ? match.index + 1 : text.length;
            }
            else {
                return currentPosition < text.length ? currentPosition + 1 : text.length;
            }
        };
        /**
         * Moves the caret of activeInput in the specified direction to a position returned by positionquerySelectorAller. Respects the state of the shift key and modifies selections accordingly.
         * @param activeInput       The input element in which the caret should be moved
         * @param direction         The direction in which the caret will be moved. Important to distinguish between selection exapnsion and reduction.
         * @param positionquerySelectorAller    A function returning the new position of the caret.
         * @function
         */
        TcHmiKeyboard.prototype.__moveCaret = function (activeInput, direction, positionquerySelectorAller, ignoreModifiers) {
            if (this.__modifiers.Shift && !ignoreModifiers) {
                if (activeInput.selectionStart === activeInput.selectionEnd || activeInput.selectionDirection === direction) {
                    if (direction === 'forward') {
                        activeInput.selectionEnd = positionquerySelectorAller(activeInput.selectionEnd);
                    }
                    else {
                        activeInput.selectionStart = positionquerySelectorAller(activeInput.selectionStart);
                    }
                    activeInput.selectionDirection = direction;
                }
                else {
                    if (direction === 'forward') {
                        var newCaretPosition = positionquerySelectorAller(activeInput.selectionStart);
                        if (newCaretPosition < activeInput.selectionEnd) {
                            activeInput.selectionStart = newCaretPosition;
                        }
                        else {
                            activeInput.selectionStart = activeInput.selectionEnd;
                            activeInput.selectionEnd = newCaretPosition;
                            activeInput.selectionDirection = direction;
                        }
                    }
                    else {
                        var newCaretPosition = positionquerySelectorAller(activeInput.selectionEnd);
                        if (newCaretPosition >= activeInput.selectionStart) {
                            activeInput.selectionEnd = newCaretPosition;
                        }
                        else {
                            activeInput.selectionEnd = activeInput.selectionStart;
                            activeInput.selectionStart = newCaretPosition;
                            activeInput.selectionDirection = direction;
                        }
                    }
                }
            }
            else {
                this.__setCaretPosition(activeInput, positionquerySelectorAller(activeInput.selectionStart));
            }
        };
        /**
         * Sets selectionStart and selectionEnd of the specified element to the specified value and sets selectionDirection to 'forward'.
         * @param activeInput   The element in which the caret position should be set.
         * @param position      The new caret position.
         * @function
         */
        TcHmiKeyboard.prototype.__setCaretPosition = function (activeInput, position) {
            activeInput.selectionStart = position;
            activeInput.selectionEnd = position;
            activeInput.selectionDirection = 'forward';
        };
        /**
         * Gets a div with the same styles as the passed HTMLElement. Only styles affecting text rendering are copied. Used in conjunction with __getCaretCoordinates.
         * @param element The element to mirror.
         * @function
         */
        TcHmiKeyboard.prototype.__getMirrorElement = function (element) {
            // Code in this method was copied and adapted from this GitHub repo https://github.com/component/textarea-caret-position
            // This code is under the MIT License
            /*
            The MIT License (MIT)

            Copyright(c) 2015 Jonathan Ong me@jongleberry.com

            Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and / or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

            The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

            THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
            */
            // The properties that we copy into a mirrored div.
            // Note that some browsers, such as Firefox,
            // do not concatenate properties, i.e. padding-top, bottom etc. -> padding,
            // so we have to do every single property specifically.
            var properties = [
                'direction',
                'boxSizing',
                'width',
                'height',
                'overflowX',
                'overflowY',
                'borderTopWidth',
                'borderRightWidth',
                'borderBottomWidth',
                'borderLeftWidth',
                'borderStyle',
                'paddingTop',
                'paddingRight',
                'paddingBottom',
                'paddingLeft',
                // https://developer.mozilla.org/en-US/docs/Web/CSS/font
                'fontStyle',
                'fontVariant',
                'fontWeight',
                'fontStretch',
                'fontSize',
                'fontSizeAdjust',
                'lineHeight',
                'fontFamily',
                'textAlign',
                'textTransform',
                'textIndent',
                'textDecoration',
                'letterSpacing',
                'wordSpacing',
                'tabSize',
                'MozTabSize'
            ];
            var div = document.createElement('div');
            var style = div.style;
            var computed = window.getComputedStyle(element);
            // default textarea styles
            style.whiteSpace = 'pre-wrap';
            if (element.nodeName !== 'INPUT') {
                style.wordWrap = 'break-word'; // only for textarea-s
            }
            // position off-screen
            style.position = 'absolute'; // required to return coordinates properly
            style.visibility = 'hidden'; // not 'display: none' because we want rendering
            // transfer the element's properties to the div
            properties.forEach(function (prop) {
                style[prop] = computed[prop];
            });
            if (window.mozInnerScreenX !== null) {
                // Firefox lies about the overflow property for textareas: https://bugzilla.mozilla.org/show_bug.cgi?id=984275
                if (element.scrollHeight > parseInt(computed.height || '0', 10)) {
                    style.overflowY = 'scroll';
                }
            }
            else {
                style.overflow = 'hidden'; // for Chrome to not render a scrollbar; IE keeps overflowY = 'scroll'
            }
            document.body.appendChild(div);
            return div;
        };
        /**
         * Gets the pixel coordinates of a caret placed in a text in the passed HTMLElement.
         * @param mirrorElement The element in which the text should be rendered.
         * @param text          The text in which the caret is positioned.
         * @param caretPosition The position of the caret.
         * @function
         */
        TcHmiKeyboard.prototype.__getCaretCoordinates = function (mirrorElement, text, caretPosition) {
            // Code in this method was copied and adapted from this GitHub repo https://github.com/component/textarea-caret-position
            // This code is under the MIT License
            /*
            The MIT License (MIT)

            Copyright(c) 2015 Jonathan Ong me@jongleberry.com

            Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and / or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

            The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

            THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
            */
            mirrorElement.textContent = text.substring(0, caretPosition);
            // replace consecutive spaces with space and non-breaking space to render correctly
            mirrorElement.textContent = mirrorElement.textContent.replace(/  /g, ' \u00a0');
            var span = document.createElement('span');
            // Wrapping must be replicated *exactly*, including when a long word gets
            // onto the next line, with whitespace at the end of the line before (#7).
            // The  *only* reliable way to do that is to copy the *entire* rest of the
            // textarea's content into the <span> created at the caret position.
            // for inputs, just '.' would be enough, but why bother?
            span.textContent = text.substring(caretPosition) || '.'; // || because a completely empty faux span doesn't render at all
            mirrorElement.appendChild(span);
            var coordinates = {
                top: span.offsetTop,
                left: span.offsetLeft
            };
            return coordinates;
        };
        /**
         * Replaces escaped characters with their unescaped counterparts.
         * @param value The string to unescape.
         * @function
         */
        TcHmiKeyboard.prototype.__unescape = function (value) {
            return value
                .replace(/\\b/g, '\b')
                .replace(/\\t/g, '\t')
                .replace(/\\n/g, '\n')
                .replace(/\\v/g, '\v')
                .replace(/\\f/g, '\f')
                .replace(/\\r/g, '\r')
                .replace(/\\"/g, '\"')
                .replace(/\\'/g, '\'')
                .replace(/\\\\/g, '\\');
        };
        /**
         * Creates HTMLElements according to the passed layout.
         * @param layout The layout to activate.
         * @function
         */
        TcHmiKeyboard.prototype.__activateLayout = function (layout) {
            if (layout === 'default' && this.__defaultLayout !== '') {
                layout = this.__defaultLayout;
            }

            var _this = this;
            Array.prototype.forEach.call(this.__elementPaddingContainer.children, function (element) {
                if (element.classList.contains(layout)) {
                    element.style.display = '';
                    _this.__currentLayout = { name: layout, dimensions: { width: parseInt(element.dataset.width, 10), height: parseInt(element.dataset.height, 10) } };
                }
                else {
                    element.style.display = 'none';
                }
            });

            if (this.__currentLayout.name !== layout) {
                this.__currentLayout = { name: 'empty', dimensions: { width: 1, height: 1 } };
            }

            this.__processScaleMode();
        };
        /**
         * Sets the default layout.
         * @param valueNew The new default layout.
         * @attributeSetter
         * @function
         */
        TcHmiKeyboard.prototype.setDefaultLayout = function (valueNew) {
            if (valueNew === this.__defaultLayout)
                return;
            this.__defaultLayout = valueNew;

            this.__processDefaultLayout();
        };
        /**
         * Gets the default layout.
         * @attributeGetter
         * @function
         */
        TcHmiKeyboard.prototype.getDefaultLayout = function () {
            return this.__defaultLayout;
        };
        /**
         * Processes the default layout.
         * @function
         */
        TcHmiKeyboard.prototype.__processDefaultLayout = function () {
            if (this.__currentLayout.name === 'empty') {
                this.__activateLayout(this.__defaultLayout);
            }
        };
        /**
         * Sets the value of the 'data-tchmi-scale-mode' attribute.
         * @param valueNew The new value for scaleMode.
         * @attributeSetter
         * @function
         */
        TcHmiKeyboard.prototype.setScaleMode = function (valueNew) {
            if (valueNew === this.__scaleMode)
                return;
            this.__scaleMode = valueNew;

            this.__processScaleMode();
        };
        /**
         * Gets the value of the 'data-tchmi-scale-mode' attribute.
         * @attributeGetter
         * @function
         */
        TcHmiKeyboard.prototype.getScaleMode = function () {
            return this.__scaleMode;
        };
        /**
         * Processes the value of the 'data-tchmi-scale-mode' attribute.
         * @function
         */
        TcHmiKeyboard.prototype.__processScaleMode = function () {
            var _this = this;
            function applyScale(scale) {
                _this.__elementPaddingContainer.style.width = (_this.__currentLayout.dimensions.width * scale) + 'px';
                _this.__elementPaddingContainer.style.height = (_this.__currentLayout.dimensions.height * scale) + 'px';
                _this.__elementPaddingContainer.style.minWidth = (_this.__currentLayout.dimensions.width * scale) + 'px';
                _this.__elementPaddingContainer.style.minHeight = (_this.__currentLayout.dimensions.height * scale) + 'px';
            }

            switch (this.__scaleMode) {
                case 'ScaleToFill':
                    this.__elementPaddingContainer.style.width = '';
                    this.__elementPaddingContainer.style.height = '';
                    this.__elementPaddingContainer.style.minWidth = '';
                    this.__elementPaddingContainer.style.minHeight = '';
                    break;
                case 'ScaleToFit':
                    var scaleX = this.__elementTemplateRoot.getBoundingClientRect().width / this.__currentLayout.dimensions.width;
                    var scaleY = this.__elementTemplateRoot.getBoundingClientRect().height / this.__currentLayout.dimensions.height;
                    var scale = scaleX < scaleY ? scaleX : scaleY;
                    applyScale(scale);
                    break;
                case 'ScaleToFitWidth':
                    scale = this.__elementTemplateRoot.getBoundingClientRect().width / this.__currentLayout.dimensions.width;
                    applyScale(scale);
                    break;
                case 'ScaleToFitHeight':
                    scale = this.__elementTemplateRoot.getBoundingClientRect().height / this.__currentLayout.dimensions.height;
                    applyScale(scale);
                    break;
                default:
                case 'None':
                    applyScale(1);
            }
        };
        /**
         * Sets the value of the 'data-tchmi-fixed-target' attribute.
         * @param valueNew The new value for fixedTarget.
         * @attributeSetter
         * @function
         */
        TcHmiKeyboard.prototype.setFixedTarget = function (valueNew) {
            if (valueNew === this.__fixedTarget)
                return;
            this.__fixedTarget = valueNew;
            this.__processFixedTarget();
        };
        /**
         * Gets the value of the 'data-tchmi-fixed-target' attribute.
         * @attributeGetter
         * @function
         */
        TcHmiKeyboard.prototype.getFixedTarget = function () {
            return this.__fixedTarget;
        };
        /**
         * Processes the value of the 'data-tchmi-fixed-target' attribute.
         * @function
         */
        TcHmiKeyboard.prototype.__processFixedTarget = function () {
            if (this.__fixedTarget !== '') {
                this.__fixedTargetElements = document.querySelectorAll(this.__fixedTarget);
            }
            else {
                this.__fixedTargetElements = null;
            }
        };
        /**
         * Sets the value of the 'data-tchmi-release-sticky-keys-manually' attribute.
         * @param valueNew The new value for releaseStickyKeysManually.
         * @attributeSetter
         * @function
         */
        TcHmiKeyboard.prototype.setReleaseStickyKeysManually = function (valueNew) {
            if (valueNew === this.__releaseStickyKeysManually)
                return;
            this.__releaseStickyKeysManually = valueNew;

            this.__processReleaseStickyKeysManually();
        };
        /**
         * Gets the value of the 'data-tchmi-release-sticky-keys-manually' attribute.
         * @attributeGetter
         * @function
         */
        TcHmiKeyboard.prototype.getReleaseStickyKeysManually = function () {
            return this.__releaseStickyKeysManually;
        };
        /**
         * Processes the value of the 'data-tchmi-release-sticky-keys-manually' attribute.
         * @function
         */
        TcHmiKeyboard.prototype.__processReleaseStickyKeysManually = function () {
        };
        /**
         * Sets the longpressDelay and calls the associated process function (processLongpressDelay).
         * @function
         * @param   {Number}    valueNew     -   The new value for longpressDelay.
         */
        TcHmiKeyboard.prototype.setLongpressDelay = function (valueNew) {
            if (valueNew === this.__longpressDelay)
                return;
            this.__longpressDelay = valueNew;

            this.__processLongpressDelay();
        };
        /**
         * Returns the current value of longpressDelay.
         * @function
         * @returns      {MeasurementValue}    The current value of longpressDelay.
         */
        TcHmiKeyboard.prototype.getLongpressDelay = function () {
            return this.__longpressDelay;
        };
        /**
         * Processes the current longpressDelay attribute value.
         * @function
         */
        TcHmiKeyboard.prototype.__processLongpressDelay = function () {
        };
        /**
         * Sets the repetitionDelay and calls the associated process function (processRepetitionDelay).
         * @function
         * @param   {Number}    valueNew     -   The new value for repetitionDelay.
         */
        TcHmiKeyboard.prototype.setRepetitionDelay = function (valueNew) {
            if (valueNew === this.__repetitionDelay)
                return;
            this.__repetitionDelay = valueNew;

            this.__processRepetitionDelay();
        };
        /**
         * Returns the current value of repetitionDelay.
         * @function
         * @returns      {MeasurementValue}    The current value of repetitionDelay.
         */
        TcHmiKeyboard.prototype.getRepetitionDelay = function () {
            return this.__repetitionDelay;
        };
        /**
         * Processes the current repetitionDelay attribute value.
         * @function
         */
        TcHmiKeyboard.prototype.__processRepetitionDelay = function () {
        };


        TcHmiKeyboard.isLayoutSwitch = function (key) {
            return key.type === TcHmiKeyboard.KeyType.LAYOUTSWITCH;
        };

        TcHmiKeyboard.KeyType = {
            "CHARACTER": 0,
            "MODIFIER": 1,
            "ACTION": 2,
            "LAYOUTSWITCH": 3,
            0: "CHARACTER",
            1: "MODIFIER",
            2: "ACTION",
            3: "LAYOUTSWITCH"
        };

        TcHmiKeyboard.KeyMode = {
            "NORMAL": 0,
            "STICKY": 1,
            "TOGGLE": 2,
            0: "NORMAL",
            1: "STICKY",
            2: "TOGGLE"
        };

        TcHmiKeyboard.KeyLocation = {
            "STANDARD": 0,
            "LEFT": 1,
            "RIGHT": 2,
            "NUMPAD": 3,
            0: "STANDARD",
            1: "LEFT",
            2: "RIGHT",
            3: "NUMPAD"
        };

        TcHmiKeyboard.LongpressAction = {
            "NONE": 0,
            "REPEAT": 1,
            "ADDITIONALKEYS": 2,
            0: "NONE",
            1: "REPEAT",
            2: "ADDITIONALKEYS",
        };


    </script>


    <!-- #endregion -->
    

</body>
